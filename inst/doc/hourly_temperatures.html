<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Eike Luedeling, University of Bonn, Germany" />

<meta name="date" content="2024-11-14" />

<title>Producing hourly temperature records for agroclimatic analysis</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Producing hourly temperature records for
agroclimatic analysis</h1>
<h4 class="author">Eike Luedeling, University of Bonn, Germany</h4>
<h4 class="date">2024-11-14</h4>



<div id="the-need-for-hourly-records" class="section level2">
<h2>The need for hourly records</h2>
<p>Many agroclimatic models operate on an hourly basis. For tracking the
transition of temperate-zone fruit trees through the dormancy season,
all major chill and heat models <span class="citation">(Anderson et al.,
1986; Bennett, 1949; Erez et al., 1990; Richardson et al., 1974)</span>
require such high-resolution information. There are some models that
operate on daily data <span class="citation">(Crossa-Raynaud,
1955)</span>, but these are often just mechanisms that use proxy
relationships to translate daily temperatures into what hourly-scale
models would produce, if temperature data at such resolution were
available. This is useful in many situations, but clearly sub-optimal,
since the relationship between chill/heat and average daily temperatures
(or daily extreme temperatures) varies substantially between locations.
Some relationships of this nature are given in <span class="citation">Luedeling and Brown (2011)</span> (though these are for
the ratios between chill metrics). As a consequence, computations based
on hourly data are always more reliable.</p>
<p>Unfortunately, hourly temperature data are often not recorded in
places, for which we would like to compute chill or heat accumulation.
Even where records have been collected, they are often incomplete, which
makes them difficult to deal with. <code>chillR</code> contains some
functions that help in such situations. In this tutorial, we use the
<code>KA_weather</code> and <code>Winters_hours_gaps</code> datasets
included in <code>chillR</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">require</span>(chillR)</span></code></pre></div>
<p>All computations should also work for different datasets, as long as
they are formatted as required by <code>chillR</code>, i.e. with columns
Year, Month, Day, Tmax, Tmin for daily data, or Year, Month, Day, Hour,
Temp_gaps, Temp for hourly records.</p>
</div>
<div id="hourly-data-from-daily-temperature-extremes" class="section level2">
<h2>Hourly data from daily temperature extremes</h2>
<p>Hourly temperatures typically follow a daily temperature cycle, which
can be described mathematically. This can be done in various ways that
differ in accuracy and mathematical complexity. <code>chillR</code>
implements equations provided by <span class="citation">Linvill
(1990)</span>, which are based on a sine curve for daytime temperatures,
with nighttime cooling represented by a logarithmic decay function.
Differences in daylength between locations are accounted for by
computing sunrise and sunset times based on geographic latitude, using
equations given by <span class="citation">Spencer (1971)</span> and
<span class="citation">Almorox et al. (2005)</span>. The results of the
latter equations can be directly accessed via the <code>daylength</code>
function, which requires only the latitude and the Julian date (day of
the year) as inputs.</p>
<p>For example, daylength, sunrise and sunset for January 15th, for a
location at latitude 50.4, can be computed by the following code:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">daylength</span>(<span class="at">latitude=</span><span class="fl">50.4</span>,<span class="at">JDay=</span><span class="dv">15</span>)</span></code></pre></div>
<pre><code>## $Sunrise
## [1] 7.766425
## 
## $Sunset
## [1] 16.23357
## 
## $Daylength
## [1] 8.467149</code></pre>
<p>Or for the whole year:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>all_daylengths<span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="at">JDay=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">365</span>,<span class="fu">sapply</span>(<span class="fu">daylength</span>(<span class="at">latitude=</span><span class="fl">50.5</span>,<span class="at">JDay=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">365</span>),cbind))</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(all_daylengths))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">JDay</th>
<th align="right">Sunrise</th>
<th align="right">Sunset</th>
<th align="right">Daylength</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">7.962814</td>
<td align="right">16.03719</td>
<td align="right">8.074373</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">7.954191</td>
<td align="right">16.04581</td>
<td align="right">8.091618</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">7.944763</td>
<td align="right">16.05524</td>
<td align="right">8.110474</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">7.934540</td>
<td align="right">16.06546</td>
<td align="right">8.130920</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">7.923534</td>
<td align="right">16.07647</td>
<td align="right">8.152932</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">7.911757</td>
<td align="right">16.08824</td>
<td align="right">8.176486</td>
</tr>
</tbody>
</table>
<p>The <code>stack_hourly_temps</code> applies these function, as well
as those proposed by <span class="citation">Linvill (1990)</span> to a
record of daily minimum and maximum temperatures. Before doing this, it
is a good idea to apply the <code>make_all_day_table</code> function to
ensure that no days are missing from the record (sometimes, missing data
isn’t marked as <code>NA</code>, but represented by missing rows in a
data.frame). The <code>stack_hourly_temps</code> requires information on
the latitude:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>weather<span class="ot">&lt;-</span><span class="fu">make_all_day_table</span>(KA_weather)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>hourtemps<span class="ot">&lt;-</span><span class="fu">stack_hourly_temps</span>(weather, <span class="at">latitude=</span><span class="fl">50.4</span>)<span class="sc">$</span>hourtemps</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>hourtemps<span class="sc">$</span>DATE<span class="ot">&lt;-</span><span class="fu">ISOdate</span>(hourtemps<span class="sc">$</span>Year,hourtemps<span class="sc">$</span>Month,hourtemps<span class="sc">$</span>Day,hourtemps<span class="sc">$</span>Hour)</span></code></pre></div>
<p>This is what the resulting table looks like:</p>
<table>
<colgroup>
<col width="31%" />
<col width="7%" />
<col width="9%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">DATE</th>
<th align="right">Year</th>
<th align="right">Month</th>
<th align="right">Day</th>
<th align="right">Tmax</th>
<th align="right">Tmin</th>
<th align="right">JDay</th>
<th align="right">Hour</th>
<th align="right">Temp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1998-01-01 19:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">8.2</td>
<td align="right">5.1</td>
<td align="right">1</td>
<td align="right">19</td>
<td align="right">6.424223</td>
</tr>
<tr class="even">
<td align="left">1998-01-01 20:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">8.2</td>
<td align="right">5.1</td>
<td align="right">1</td>
<td align="right">20</td>
<td align="right">6.203183</td>
</tr>
<tr class="odd">
<td align="left">1998-01-01 21:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">8.2</td>
<td align="right">5.1</td>
<td align="right">1</td>
<td align="right">21</td>
<td align="right">6.022917</td>
</tr>
<tr class="even">
<td align="left">1998-01-01 22:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">8.2</td>
<td align="right">5.1</td>
<td align="right">1</td>
<td align="right">22</td>
<td align="right">5.870701</td>
</tr>
<tr class="odd">
<td align="left">1998-01-01 23:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">8.2</td>
<td align="right">5.1</td>
<td align="right">1</td>
<td align="right">23</td>
<td align="right">5.738969</td>
</tr>
<tr class="even">
<td align="left">1998-01-02 00:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">9.1</td>
<td align="right">5.0</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">5.574983</td>
</tr>
<tr class="odd">
<td align="left">1998-01-02 01:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">9.1</td>
<td align="right">5.0</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">5.468975</td>
</tr>
<tr class="even">
<td align="left">1998-01-02 02:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">9.1</td>
<td align="right">5.0</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">5.373123</td>
</tr>
<tr class="odd">
<td align="left">1998-01-02 03:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">9.1</td>
<td align="right">5.0</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">5.285650</td>
</tr>
<tr class="even">
<td align="left">1998-01-02 04:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">9.1</td>
<td align="right">5.0</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">5.205208</td>
</tr>
<tr class="odd">
<td align="left">1998-01-02 05:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">9.1</td>
<td align="right">5.0</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">5.130750</td>
</tr>
</tbody>
</table>
<p>And here is a plot of part of the data:</p>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>This plot shows a smooth temperature curve, which can now be used for
computing metrics that require such data (see below).</p>
</div>
<div id="patching-holes-in-daily-temperature-records" class="section level2">
<h2>Patching holes in daily temperature records</h2>
<p>Quite often, the procedure outlined above isn’t sufficent for
producing a continuous record, because some daily data are missing.
Let’s make such a dataset from the KA_weather data as an example:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>KA_weather_gaps<span class="ot">&lt;-</span>KA_weather[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,]</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>KA_weather_gaps[,<span class="st">&quot;Tmin_original&quot;</span>]<span class="ot">&lt;-</span>KA_weather_gaps[,<span class="st">&quot;Tmin&quot;</span>]</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>KA_weather_gaps[,<span class="st">&quot;Tmax_original&quot;</span>]<span class="ot">&lt;-</span>KA_weather_gaps[,<span class="st">&quot;Tmax&quot;</span>]</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>KA_weather_gaps<span class="sc">$</span>Tmin[<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">15</span>,<span class="dv">20</span><span class="sc">:</span><span class="dv">30</span>,<span class="dv">35</span><span class="sc">:</span><span class="dv">40</span>,<span class="dv">44</span><span class="sc">:</span><span class="dv">45</span>,<span class="dv">48</span>,<span class="dv">50</span><span class="sc">:</span><span class="dv">60</span>)]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>KA_weather_gaps<span class="sc">$</span>Tmax[<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">12</span><span class="sc">:</span><span class="dv">15</span>,<span class="dv">17</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">30</span><span class="sc">:</span><span class="dv">35</span>,<span class="dv">42</span><span class="sc">:</span><span class="dv">60</span>,<span class="dv">65</span><span class="sc">:</span><span class="dv">70</span>)]<span class="ot">&lt;-</span><span class="cn">NA</span></span></code></pre></div>
<p>In such cases, we have two options for fixing this situation:</p>
<ul>
<li>we can interpolate the gaps</li>
<li>we can use data from another weather station to fill the gaps</li>
</ul>
<p>The first option - interpolation - is implemented in the
<code>fix_weather</code> function:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>fixed<span class="ot">&lt;-</span><span class="fu">fix_weather</span>(KA_weather_gaps)</span></code></pre></div>
<p>This operation resulted in a continuous record of daily minimum and
maximum temperatures, but the linearly interpolated values were not very
accurate. This is shown in the figure below, where the thick blue and
red lines are the actual Tmin and Tmax values and the black lines
represent the interpolated values.</p>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>For small gaps, such linear interpolation often produces accurate
values, but when gaps are longer, deviation from actual values can be
quite substantial.</p>
<p>Gaps in the record can also be patched with proxy data from other
weather station in the area. In this, it is critical to ensure that the
proxy station is situated in a location with reasonably similar weather.
Filling in gaps with records from somewhere else can easily introduce a
bias - a systematic difference between stations - that could lead to
large errors. These issues are addressed by the
<code>patch_daily_temperatures</code> function, which uses one or more
daily temperature datasets to fill holes in patch records.</p>
<p><code>chillR</code> contains a function that can look through the
‘Global Summary of the Day’ database and identify stations based on
their coordinates. <code>handle_gsod</code> can do most of this work.
When supplied with the <code>action</code> parameter ‘list_stations’,
its output is a list of weather stations in the database that are close
to the specified coordinates (in <code>c(longitude,latitude)</code>
format).</p>
<p>To run the code below, remove the comment marks (#). Retrieving these
records can sometimes take a bit of time (especially when loading many
years). It also depends on internet connectivity, and on the host
website still operating and using the same protocols as when the
function was written.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># stations&lt;-handle_gsod(action=&quot;list_stations&quot;,location=c(6.99,50.62),</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#                      time_interval = c(1998,1998))</span></span></code></pre></div>
<p>This list contains a column <code>chillR_code</code> which can be
passed to the same function, when specifying the <code>action</code>
‘download_weather’. Applying the same function to the resulting file
then returns a dataset that <code>chillR</code> functions can easily
use. Note that many records in this particular database have lots of
gaps themselves, so it is quite common that the closest station listed
there isn’t the most useful one.</p>
<table>
<thead>
<tr class="header">
<th align="left">chillR_code</th>
<th align="left">STATION.NAME</th>
<th align="right">Lat</th>
<th align="right">Long</th>
<th align="right">distance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">105180_99999</td>
<td align="left">BONN-HARDTHOEHE</td>
<td align="right">50.700</td>
<td align="right">7.033</td>
<td align="right">9.40</td>
</tr>
<tr class="even">
<td align="left">105170_99999</td>
<td align="left">BONN/FRIESDORF(AUT)</td>
<td align="right">50.700</td>
<td align="right">7.150</td>
<td align="right">14.39</td>
</tr>
<tr class="odd">
<td align="left">105190_99999</td>
<td align="left">BONN-ROLEBER</td>
<td align="right">50.733</td>
<td align="right">7.200</td>
<td align="right">19.45</td>
</tr>
<tr class="even">
<td align="left">105130_99999</td>
<td align="left">KOLN BONN</td>
<td align="right">50.866</td>
<td align="right">7.143</td>
<td align="right">29.42</td>
</tr>
<tr class="odd">
<td align="left">105060_99999</td>
<td align="left">NUERBURG-BARWEILER</td>
<td align="right">50.367</td>
<td align="right">6.867</td>
<td align="right">29.47</td>
</tr>
<tr class="even">
<td align="left">105080_99999</td>
<td align="left">BLANKENHEIM</td>
<td align="right">50.450</td>
<td align="right">6.650</td>
<td align="right">30.64</td>
</tr>
<tr class="odd">
<td align="left">105100_99999</td>
<td align="left">NUERBURG</td>
<td align="right">50.333</td>
<td align="right">6.950</td>
<td align="right">32.05</td>
</tr>
<tr class="even">
<td align="left">105020_99999</td>
<td align="left">NORVENICH</td>
<td align="right">50.831</td>
<td align="right">6.658</td>
<td align="right">33.17</td>
</tr>
<tr class="odd">
<td align="left">105140_99999</td>
<td align="left">MENDIG</td>
<td align="right">50.366</td>
<td align="right">7.315</td>
<td align="right">36.47</td>
</tr>
<tr class="even">
<td align="left">105090_99999</td>
<td align="left">BUTZWEILERHOF(BAFB)</td>
<td align="right">50.983</td>
<td align="right">6.900</td>
<td align="right">40.88</td>
</tr>
</tbody>
</table>
<p>In this present example, which is set in Klein-Altendorf, the
experimental station of the University of Bonn, Germany, only the
forth-closest record (Cologne/Bonn Airport, about 30 km from the site)
contained adequate data for the period of the weather record of
interest. The following code accesses and processes the data for this
station for the analysis. Again, uncomment the code below to actually
run the functions.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># patch_weather&lt;-handle_gsod(action=&quot;download_weather&quot;,stations$chillR_code[4],</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#                      time_interval = c(1998,1998))</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co"># patch_weather&lt;-handle_gsod(patch_weather)$weather</span></span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Year</th>
<th align="right">Month</th>
<th align="right">Day</th>
<th align="right">Tmin</th>
<th align="right">Tmax</th>
<th align="right">Tmean</th>
<th align="right">Prec</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4.222222</td>
<td align="right">8.722222</td>
<td align="right">6.055556</td>
<td align="right">4.572</td>
</tr>
<tr class="even">
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">4.222222</td>
<td align="right">9.888889</td>
<td align="right">7.777778</td>
<td align="right">0.254</td>
</tr>
<tr class="odd">
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4.277778</td>
<td align="right">10.888889</td>
<td align="right">7.888889</td>
<td align="right">3.048</td>
</tr>
<tr class="even">
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4.388889</td>
<td align="right">9.277778</td>
<td align="right">7.333333</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">4.722222</td>
<td align="right">8.777778</td>
<td align="right">6.388889</td>
<td align="right">0.254</td>
</tr>
</tbody>
</table>
<p>Patching the gaps can then easily be done with the
<code>patch_daily_temperatures</code>function.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>patched_weather<span class="ot">&lt;-</span><span class="fu">patch_daily_temperatures</span>(KA_weather_gaps,patch_weather)</span></code></pre></div>
<p>The resulting list contains two elements. Let’s first look at the
second one, which is called <code>statistics</code>:</p>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">mean_bias</th>
<th align="right">stdev_bias</th>
<th align="right">filled</th>
<th align="right">gaps_remain</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Tmin</td>
<td align="right">0.317</td>
<td align="right">1.232</td>
<td align="right">43</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Tmax</td>
<td align="right">-1.001</td>
<td align="right">0.928</td>
<td align="right">47</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>This table contains information on the stations used for patching
(only one in this case), the mean bias for Tmin and Tmax, and the bias
in the standard deviation of both metrics between stations. The function
automatically corrects for the mean bias, but not for the standard
deviation one. The table also describes how many gaps were filled with
this data, for Tmin and Tmax, respectively, and how many gaps remained.
In this gaps, no gaps remained, but in other cases, it is possible to
close remaining holes by adding more prpoxy stations or by using linear
interpolation.</p>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Even though the original dataset of 100 days was missing 43 minimum
and 47 maximum temperatures, the gaps are now barely visible, with the
patched datasets corresponding quite closely to actual temperatures.
These can now be translated into hourly temperatures with the
<code>stack_hourly_temps</code> function, as described above.</p>
</div>
<div id="interpolating-hourly-temperatures" class="section level2">
<h2>Interpolating hourly temperatures</h2>
<p>Sometimes we have actual records of hourly temperatures. While this
is preferable, in principle, it may cause problems when the record isn’t
complete. An example of such a record is the
<code>Winters_hours_gaps</code> dataset contained in
<code>chillR</code>. This is quite often the case, because temperature
loggers can temporarily fail for many reasons. Gaps in such records are
even harder to fill, because in this case, linear interpolation is
usually not an option for gaps that span more than a couple of hours.
Here’s an illustration of the error that may arise from this:</p>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAAbFBMVEUAAAAAADoAAGYAOpAAZmYAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmAGZmZgBmkJBmtv+QOgCQOjqQZgCQkGaQ2/+pqam2ZgC225C2/7a2/9u2///bkDrb////AAD/tmb/25D//7b//9v///9NsV2OAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAWGElEQVR4nO3di3ajuhUGYM9Mk3OaTNtJ28Ftx2PH1vu/Y7kjQJe92RKS8P+vdc4kBm9k8wULMOKkEESQU+oGIGUHgBBRAAgRBYAQUQAIEQWAEFEACBEFgBBRAAgRBYAQUQAIEQWAEFEACBEFgBBRAAgRBYAQUQAIEQWAEFFiAzohB0oKQJHrIzsGgBBRAAgRBYAQUQAIEQWAEFEACBEFgBBRAAgRBYDoMR51DTBv0QEgeq4MFeZj/AcMANFDBWQ/SXTAABA9AGQIAJFTXYmCWj0AtO8yCwgDkHqeXjQA0VLVYQF6FkEAREvrh6gCgBIsM/cAkCUAREtVKQAy5dkB1TCoswGQKQBEErQB0JMIenJAFQAJ89yAKiKgwU8GgHJj+eyAaJ2grADl8/Y1eXpAJEH5AMruJBsABQc0zhNjVQPQDvXJae0UBSi/s7QAxAJEWX0ABECmGQHIGAAiAur8ZAAoM0HPDKijA0CiAFA8QBFWNQDtUZ8aAAoQAAIgUQAoB0DUGTP8tjUA0QD1fqIBos0JQLvUJ2aQ4xc0bYDCA+pNAJBwmQmSC6ATAAVYZsDq1PKRAGlzUAGRz5AC0A71yaerNwHyrz4AAiDDnBkAGi+452iLnoSAIr1AKqDRTXJAxDOkIzNiP2yfbw4lBRRlQVEAjX5CAxoG8gh8jq3frnnnkycCoMdH9658/eVe5vEBkbrcALTI5fTW/XAbfjDXj/TVFnKHNCNApDmfBdDjY2Rz+fbbvsxYY+gAUF+2VED39x/DjzfLh9hpWM0ANDYXgIbQtkD0/QluygLEQ8GZt1hAdR+o3wS5+kCFAZr8lAMoUhdhtSTiY4zc37tdC8v2Jy4g+ts2ufEJqqIBmqYDEG+ZxwU0m+6ZWd9YUrpL5FmPCUi/zSYALScD0JhL3fa2G3Rx7YX1P4Z+iccFxNla9V3oMgFdvvysu0EvygWI88fEC/3oAAAFSaTd+MdH3YUGoEiAKI0oFtBwIPH87XcCQOSjcroaLyDNDw+QZ+64gKIcJVkvivgYOeOBxPMLACUE1EZveKRE6AP1bO7vtvPx+rY1sKAnAUT9bCwS0Hgo+vGRChClKgCFSZIDiazjZ8zS1KoAFCYABECiHAsQ4/gkA9BsNQDQYlHEx4IuE4DWU0MCGqcCELsyuWppgDbVBSB2ZXLVDABxPpQASK8PQOuJUQBV8QUBEBMQtf9KmBmAti4zOiBCWQAKk2cFpKMBIEEOBWgqlgzQYiodEA8mtTAAMQuTywJQoADQ8pd1AMi1LOJjQZcJQIaJzwHo1l9X8cM+C2GZAGSY+ASA7u+nl+6nx4d98BbCMssCdL3OJrMAOed+NkD3v/2y/sZbJgAZpkUBFH8/Hn2g5S+rFAdImwZAvLrmn00BoEBhAXp8NH2gz1fLqBvkZfIBke7vHg2QdSnuNnjm5nwoHQPQ/b0bcGP4d/MytwHyCioMEKvuIQCdBzf3d9E2iLOi+9Sr2C8IgFbTsgJEGHuMv0w/oHaOinKDdwageS1n5UUXKBNAxM/GrAARRj/kL5MC6Eq8MRMArSflBWjaAgEQoQ2euZ8OkDq/jD/t+hGWFyDO6YlwgFZTSwT0+fpj8YN8mSRA/QoGINrs2QIaxl292IZf3bBML6DaDwAdBVB/G4wX63T+Mo8OyDG3DJBj/owBhV9mLECewnRA49Ipla+c9bxctzyY4QARjvE7Ugag7sfcAV2bOBu1mJ06p3FiQEASQRxAN/mn16q+D1A9vRBALZ91pf0BzSbkBKj5BtBZtPtlqu8RVL8BJQC69lsfALI9ptIBGg/HZwvoOn54AZDtsSYxPsIIgFR4QItKMkB614cBaHWa6viAQmUrIJ+gzYBchX2A5j3nHQFZ5589TjibCkDGUoEAGfrF852c+Y5XdoAIm6Bd+0C237Yv0w2o60DTPsNO9LqBAK332wHI9liTYJf1zH4pFdDVdNiHAWj13OMDUqEuLJz94gE0/T8rQEY++wMyPSdrQEGyCyDnOycFZNZjLBQTkPn2ngCkJU9ANj7GQrYXKAakLDfkASAt/cvv/9kf0PW6ntYAohZeN8vePgDatEzn2zacxdgCyHUERATI1QwAsj0WMgDUl6bNaJ1IAuQXlBmg7qv3zd6adUd/H0Cud644QMZpZkCMt6HLvoDu76dvv8+Or7S2gNrrxrTLgBz1PYBm/x4bkOutsAAyTcgb0O3LzxqH68rUZlpPx3b5IR+Qsp3rdlVyfIYdA5B5QtaAmotTL47b6aoOUH/Vhu3yw82A3ILKAmRo3RMAajYtDSDHlakht0DT99k3AzI/gwrIXAGA9MURH+sybIEcFxbWnaT+wg3rB91egKp2+2F6CgDpLeEBWsy9qQ90cZ8Lqw19+TlcROarHw+QygOQ5RVmBYgjaDH3hr2wU8NDkg2AKL1oASBbYS4g45SogNZTlg+4D/WrvQEJchozf9T+DCmgqjmTJQRkmFIWIK+gPQFpQwQJQgWkn8gEIOqUjYDIiESArMcGWYkDaF1IDMi2G2dtRrmA6Jsh2UeYf2Spbi+si/A40OyrFO37zQOkcgZk6NumANTbIY1BOTxDtAVy02jy+PAhAyCVEaBBDxHQUlqETnQ3GLAj8/r21wdAhEn+na7iAKmb5yvT+wGqzL3gvQGZvkBdNqCpZviPMH+IgOYrv3RAhON7jM8p+6S9AA1FN22BZIO0bgNkXZuOOnkA6h6t/N/zeh5A2nCbW7IboH5H3vS474FhiQUA8h6YdQnS9uFpgtp5T1JA4caJDgbIWOZJAF3ds7oBKdahxI6bGFC4caIBSAvjlKm11EZAig6ofSkyQPf3HT7ClmC2AyJwASAGoGaBGwENe2HCu/XMfyMCspyYcpapzIJ2BjT+2a6KLzLMsmqxG9DsrEjegMIEgFRQQGo/QIOfqShzC/S9+ybQHp3oYIDWbw0NkOP8ra0dwQAtKh0O0B6d6DCAjE8zlDE8BEDm2bulbQF0ns6zy244N/8tIiDL044GSOsEmeZ0PLtbTDX841yK0jdAwi2QLCRAhg6IeZfcWUVlAagVMT/gZ7zmKB0g7RfngqSAwmRfQIanJQBUVWomyHzRWj8HF5ByA3I8fbaYPQAN+/Hx+0CGzm/hgFQ8QFO13AGdv/2+vIS8X1jugByHBlmPt1O0RrIA+fwEAuQXNPWht/aB3t/Urbm0OdgdCzmA9Ks0VjUd7/HqaSRArm9hOzrLlglLQOartQoCNBTlAvqhPv/81f63PRRAxj9/ALLVLwVQc1lPsycGQMYFpQNULT5YzHVNT7T/Zp59SZXZB2qOIJ7fdvgICwloubZM71NcQMORlqmVYQGpYgA1XyWr98TifyMxMCD/+7R60HklGq9vXQogr6BqfcQp1+NA5l0g89turzI+rVLa+UkA0trl+tUwtxBQhEub9wDUHY3mAbo6xwOJBGh62QcFFOHS5h0BDdXSAZqauS8g6+NcQOvTtsyPMOH1GKb6ALRc6oEBxbguzPziIgAay8UC5Hj7h0nRAFWzL+msY56ybLEPkOHLs+k70XsA6r5bnxDQkFiAFAAtAkCmZ9lTDCDvQOOEAFAEQM3Kdc1nnMYENG/0tk60d6BxQgiALAdhNgOqukNBw2/GWYyL2hnQ+BXugwIiDDROSJaAlo+WB8h49zl3jVWLnS9hWaL9nX8cyDPQOCHbAVkFed7iBtD10IBUGYAIA40TkgJQNY3RQzPhBmR8PASgYTwRNiD6ovWl+R9xVNgAiDbQuC9JAKnrQCgWIIIfAAo/0PgugLr0m6EcANmPDB8dUIj4AVnXnhCQUtb7LS8WNsy0O6DhK9x6NQBy1ucAst3CiQzITsgIyPqGApDkI0w2OEdiQKoyC8oI0LJaEECGKmk60fX/L7JOUGpAQ4faONXXAuPc7nm1EAAZ+n+RAJl6CNYDbYbnb9qN73a/gu7GG96f2ICmXbL1ZE8LTDNbH7K20/UNr0SArqaxZJ3P33IgMcLwLoaW2ddeKEDdUuaEnhbQdYprUSG3QCGvyuABsgjaAmhJiAWI23/okxugq47Hs6gQgPpB6MMeSEwHqCO0mKy3IAWg/iWGBzQvs6LjXVSQjzD/rXgIyQiQTigLQGoXQEY7vkUF2QIFSSpAfcHVIWfDKY7DAtLpmBp8dEA2QQJA45uaDSC1XLvBAM03PFJA7SNMQBHGB1q3zLX2YgDqljnbnh8X0GxR9gaSpvABPT4Iu1+PDw+yHAHVS9VrpASkYgFatpAHyPC+8wFRLiy8DCNwWm8cnycgvcj40/6A2lyvBwVEuLRZm8V2tChvQO27cqrsTbBNAaDxcXsTPv/wnQXTNlK249UyQLZXQggFUHsjGgKg9SQAGh+3N+Hz1deJlm+BxpbSAbnOAc6fbCk7tGM4yFVFAjS8Vh+J+T7hcQB576ertMPUW/tACQF198ECIHOLjDOH70T7b+mTM6D+35wAOU+RszJvobG9kQHFGB9ILVudASCVDyD7d3D5SQ+I0Im2ZzqNZmrIFB8gA5dggOZzpgM0rC/XVQD8pAcUZXiXQgGtpkUA5LwOiZ/0gMLEDcj8/Qr9MRkg++rIDpD7Skh+BICM45tGAUT4xke+gOZzOmeODEh5TnpuCgGQrWXBAPmHd3l8+D7fJIDMvegwgFazJgfEKExJBoAow7t4Dxat65vOY9oBrb3kAIhWlwOIV5kQCiBL08xDdDeHXk0PW1tAG97l5vnGKwBRDg1O9Q4EKMrwLmrWaNu33PUH8wBEWx+LPDmgKMO7KBYgYyeIeqitqQhAnrKmtlkORrEBRRneRbEBrcAAEC2zSkkAxRjeRQGQu3rOgMzfztrQNE4AKGtApsblDkhrsxeQqRMEQLRIAJnn5AAKc6cVc/2xzXqDAIhTmRK9kr3qunG2E7o1IEYfKCNASzHhAfWzPSWgdesASHsqB5B7XgDKG5DtFQLQ5mgfzK6iDEAVC1CIkRXM9QHIUT0CoMpddH2djPXToMAtkKEXDUDEdLfdCwdI5QaI0AUybYIODSignxZQ1f/fETogzpFoADLOY/zFGjqgsWACQOsLZQBofCYApQIULMZldg+WBYi6W6yFAYh0MJOZaopzPgCyP7MkQP6Dmcz02x8FQHMz5EvvfLsfi4WkBdSvZgAiLbN90DuA1jQlC0D6DMS648Wv4RrByDZAi8FC5nMSHwsZAKIC4nzmMuoBkAAQdXUcE9BU8+kBzeYFIGYACIBE8dZcXutZBqC5gxIAaXMUBcgbALI9MzWg7pVSATF6/WGzuNTT3oZcALUtpgJa9aIzAEReze0F5eS3GICo9dmA9Lk5gMhzupugzzb7wRcAEgeAAEiUIwEaZwEg92MhYwO0YHBYQIZRIl31UwNyj7KXDaD1RWplABrmoa/mQgCNbQSg2RPTA1IsQIwmB81pPNxwRECL/XjLhbeW5zHmJM3ezcQCRJ5VJQM0HK86te9uGYBO8QHRU5EPAtOpbWxIrMqedL39ogDNm5kWkPJe+6K3Jd1qjpfSAK021okB0fegk52wipseUPttxDIALVaDc53MBMUBRN4BOjag09X5RgCQaxlPDagRBECSABAAyULdg051viFyCgfkWSVVlROgI/pR/e1j3a+vZECjoHiAqPMdF1AbAIqc4wOyz0R8LGQAqJBQTtrlBUhXUxagtMuPFABCRDk0IF0QAMUJACGiABAiCuWLSwCEiFI2oF4QAKVLcEDdDXlvrsHIAehAiQOouS2mfVRXV/2JjffYyvQZBkDpEgVQT+diubMqAB0oUQB9vraAFvd2nu604Xr+6IYOyDEEJBI7uW2BRjd+E2MnCIASJgKgZhvzoobuNLc+AJWVGLvxtaEvP+sdMYsfT/0eAwCVkcyOAykWoAqAkqdgQAqAMkjJgAZBAJQwAISIUjSg/tIMAEoYAEJEyQ9QT4d6UWg3fAQApUrxgKp+/AgkTQAIEaVwQE01AEoZAEJEASBElCwBVaxrPWtBAJQsGQLiDtgEQCmTIyDmgE0AlDIAhIiSJSDeiE0NIElzEEkOAQgboHTJE9BRR2w6YAAIESVbQJHbgARKpoCQUgJAiCgAhIgCQIgoAISIAkCIKACEiAJAiChJACEHSgJAQRKrkdFe/BM1GIBKKpxhgwGopMIZNhiASiqcYYMBqKTCGTYYgEoqnGGDAaikwhk2GIBKKpxhgwGopMIZNhiASiqcYYOLAITkGwBCRAEgRBQAQkQBIEQUAEJEASBEFABCRAEgRBQAQkQBIEQUAEJEASBElJwAPT76mz/fTua70N9OzS2im3/a/AhcV6nL8EOgwkp9/vlr8UPQurEaPN3Q3ZfMAHUv62x+ebfmBuPD+3V/p7w8Xt1z/b/PV6pLf+GmlV9/zX8IWvdS///GEEQu/PkHtWhegP7yvWn3/W9/N728x0fz13Pu3VzoK4Ra9/7e/HCx/W2yC7ebtq6Z4w9B67YNfnyQ/5LoDb6RW5sXoJdzswpv3/7VvLxz9yl1//7v7kV124YezufrW/C63d8y4y/aU7heHW/dmhh/CFy3nzl84Qu5ZmaAbu3rejvX/zSbmku9Mu/v/R9Lt1nt37kzb32Q6vaAyH0rX2GltD9lJiBy3XZS8MLnv9a2SH+imQFqunD37z/rl3dvtrXNxqH7YFHDpqH7//hgyLr9pogFyFW4Lb4RELXujbieeYU7UmdK5cwAPT5+1NvX3+fuT+LWbGHv7/0K1QFxeo70ul0nmgXIVbh9ZCMgct16Zk6njVGY1uTMADUfvjX85uXVe6hf//OqvTz9I+xMf9M4detOwdf/fuf0gVyFldoOiFyX22ljFCbtkOYG6PPP//3zZ/Py2tZ/zlb01IlmfYIx6ra/0g/YeAo32QyIWpe4njcVpuzL5wbo8fGPegXWL699ITd9A6vtxnMO1nDqNmHtxjsLN9kMiFK3exsYlSMUzg1Q/Snyooa/j/t73UOcXt50IJHVBSLXbY9N8o7LuQsrASBS3eaDqPMfunDz51RiJ7rfi+4/ob/8rLu12ssbD9wzjiJy6jYH8Jm9c3dhCSBS3TPjjE6cwjkBQgoMACGiABAiCgAhogAQIgoAIaIAECIKACGiABAiCgAhogAQIgoAIaIAECIKACGiABAiCgAhogAQIgoAIaIAECIKACGiABAiCgAhogAQIgoAIaIAECIKACGiANCmnE3jxN44Iz4cJQC0Kd34RJ+v+lCCs0vMnyYAtCnDAF/6UAwAhJDTA+pGSO1Gsvh8PZ26IS84oxYWHwDalGGIvflgpz+6HzhDEBcfANqUAdDl6y9tsNNhwFPOWEClB4A2RQPU/DMOdtp1ingj8JUdANoU/SNMH+yUex+Y8gNAm6J1omeDnfIGbzxCAGhTtN342WCnz7crD0CbMhxIfBs2Pu1gp2/9nSvOT7QdAqBN0U9lDIOddjfhao4DPdFOGAAhsgAQIgoAIaIAECIKACGiABAiCgAhogAQIgoAIaIAECIKACGiABAiCgAhogAQIgoAIaIAECIKACGiABAiCgAhogAQIgoAIaIAECIKACGi/B/P/8krz5XsVAAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
<p>In this interpolation, some daytime or nighttime cycles were missed
entirely, which can lead to substantial errors when calculating
agroclimatic metrics, such as chill or heat stress that are of
particular concern during the warmest and coolest parts of the day.</p>
<p><code>chillR</code>’s <code>interpolate_gaps_hourly</code> function
provides an algorithm that can produce credible and continuous hourly
records from such a patchy dataset. It combines several of the elements
described above, but also adds functionality to derive daily temperature
extremes from hourly data that were recorded. Without going into too
much detail, here is the rough mode of operation:</p>
<ol style="list-style-type: decimal">
<li>Express temperatures for each hour as a function of daily
temperature extremes using the functions of <span class="citation">Linvill (1990)</span>. According to this idealized
curve, all hourly temperatures can be expressed as a function of Tmin
and Tmax on the previous, same or next day of the temperature record
(depending on which hour is of interest). For a day with a complete
record, 24 equations can be set up.</li>
<li>For each daily temperature extreme, empirically solve the system of
all equations that contain the respective Tmin or Tmax variable (this is
only attempted, when a minimum of 5 equations are available, to avoid
spurious results).</li>
<li>Close gaps in the resulting dataset of daily Tmin and Tmax using
data from proxy stations or, as a last resort, linear
interpolation.</li>
<li>Compute idealized temperature curves from the now continuous record
of daily Tmin and Tmax values.</li>
<li>Calculate the difference between recorded temperatures and this
idealized curve.</li>
<li>Linearly interpolate this difference and add this to the idealized
temperature curve.</li>
</ol>
<p>The following code calls this function for the Winters dataset, using
daily data from a nearby station of the California Irrigation Management
Information System (CIMIS) as a proxy. This is retrieved with the
<code>handle_cimis</code> function, which works similarly to the
<code>handle_gsod</code> function described above. As before, uncomment
the code to run the function (The CIMIS database seems to have
occasional connectivity problems, and they’ve at least once made changes
to their data storage system that required changes to the
<code>handle_cimis</code> function. So it’s possible that the process
times out or returns an error).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co">#stations&lt;-handle_cimis(&quot;list_stations&quot;,location=c(-122,38.5))</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#downloaded_winters&lt;-handle_cimis(&quot;download_weather&quot;,stations$chillR_code[2],</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#               time_interval = c(2008,2008))</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#winters_daily&lt;-handle_cimis(downloaded_winters)$weather</span></span></code></pre></div>
<p>Here’s what the dataset looks like:</p>
<table>
<thead>
<tr class="header">
<th align="right">Year</th>
<th align="right">Month</th>
<th align="right">Day</th>
<th align="right">Tmin</th>
<th align="right">Tmax</th>
<th align="right">Tmean</th>
<th align="right">Prec</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2008</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2008</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">-1.7</td>
<td align="right">13.6</td>
<td align="right">5.0</td>
<td align="right">0.0</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">1.5</td>
<td align="right">12.2</td>
<td align="right">6.9</td>
<td align="right">12.0</td>
</tr>
<tr class="even">
<td align="right">2008</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">8.0</td>
<td align="right">11.0</td>
<td align="right">9.2</td>
<td align="right">132.8</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">5.3</td>
<td align="right">9.5</td>
<td align="right">7.2</td>
<td align="right">10.3</td>
</tr>
</tbody>
</table>
<p>And here is the call of the <code>interpolate_gaps_hourly</code>
function:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>to_interp<span class="ot">&lt;-</span>Winters_hours_gaps</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>to_interp[,<span class="st">&quot;Temp_recorded&quot;</span>]<span class="ot">&lt;-</span>to_interp[,<span class="st">&quot;Temp&quot;</span>]</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>to_interp[,<span class="st">&quot;Temp&quot;</span>]<span class="ot">&lt;-</span>to_interp[,<span class="st">&quot;Temp_gaps&quot;</span>]</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>interp<span class="ot">&lt;-</span><span class="fu">interpolate_gaps_hourly</span>(<span class="at">hourtemps=</span>to_interp,<span class="at">latitude=</span><span class="fl">38.5</span>,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>                                <span class="at">daily_temps=</span><span class="fu">list</span>(<span class="at">Winters=</span>winters_daily))</span></code></pre></div>
<p>The resulting dataset has two elements: <code>$weather</code> and
<code>daily_patch_report</code>. Let’s first look at the
<code>daily_patch_report</code> element:</p>
<table>
<thead>
<tr class="header">
<th align="right">Var</th>
<th align="right">Proxy</th>
<th align="right">mean_bias</th>
<th align="right">stdev_bias</th>
<th align="right">filled</th>
<th align="right">gaps_remain</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">Tmin</td>
<td align="right">solved</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">193</td>
<td align="right">61</td>
</tr>
<tr class="even">
<td align="right">Tmin</td>
<td align="right">Winters</td>
<td align="right">0.282</td>
<td align="right">1.908</td>
<td align="right">61</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">Tmin</td>
<td align="right">interpolated</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">Tmax</td>
<td align="right">solved</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">204</td>
<td align="right">50</td>
</tr>
<tr class="odd">
<td align="right">Tmax</td>
<td align="right">Winters</td>
<td align="right">-1.835</td>
<td align="right">2.393</td>
<td align="right">50</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">Tmax</td>
<td align="right">interpolated</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>This table contains information on how many gaps in the daily record
were filled by solving the system of hourly equations (‘solved’), how
many Tmin and Tmax values were derived from proxy stations (listed by
name, if names were provided in the call to
<code>interpolate_gaps_hourly</code>; otherwise as station_x), and how
many were filled by linear interpolation (this option can be turned off
using the <code>interpolate_remaining</code> parameter). For proxy
stations, it also provides the bias in mean Tmin and Tmax, which has
been corrected, as well as the bias in the standard deviation of Tmin
and Tmax (which was <em>not</em> corrected).</p>
<p>The <code>$weather</code> element of the interpolation result
contains the table of interpolated temperatures.</p>
<table>
<thead>
<tr class="header">
<th align="right">Year</th>
<th align="right">Month</th>
<th align="right">Day</th>
<th align="right">Hour</th>
<th align="right">Temp_gaps</th>
<th align="right">Temp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">15</td>
<td align="right">21.867</td>
<td align="right">21.867000</td>
</tr>
<tr class="even">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">16</td>
<td align="right">21.604</td>
<td align="right">21.604000</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">17</td>
<td align="right">20.079</td>
<td align="right">20.079000</td>
</tr>
<tr class="even">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">18</td>
<td align="right">17.344</td>
<td align="right">17.344000</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">19</td>
<td align="right">13.930</td>
<td align="right">13.930000</td>
</tr>
<tr class="even">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">20</td>
<td align="right">11.929</td>
<td align="right">11.929000</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">21</td>
<td align="right">NA</td>
<td align="right">11.112690</td>
</tr>
<tr class="even">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">22</td>
<td align="right">NA</td>
<td align="right">10.523682</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">23</td>
<td align="right">NA</td>
<td align="right">10.082399</td>
</tr>
<tr class="even">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">9.497437</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">9.222170</td>
</tr>
<tr class="even">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">9.007891</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">3</td>
<td align="right">NA</td>
<td align="right">8.842075</td>
</tr>
<tr class="even">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">NA</td>
<td align="right">8.715698</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">NA</td>
<td align="right">8.622042</td>
</tr>
<tr class="even">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="right">NA</td>
<td align="right">8.555974</td>
</tr>
</tbody>
</table>
<p>Here’s a plot of part of the data:</p>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAAbFBMVEUAAAAAADoAAGYAOpAAZmYAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmAGZmZgBmkJBmtv+QOgCQOjqQZgCQkGaQ2/+pqam2ZgC225C2/7a2/9u2///bkDrb////AAD/tmb/25D//7b//9v///9NsV2OAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAW6UlEQVR4nO3dDXejuBUGYM9sk91Opu2k7eC247Xj8P//YwEJEKCPe7kSSPC+5+xOYuOLDE/4RlxqBBHksncDkLIDQIgoAISIAkCIKACEiAJAiCgAhIgCQIgoAISIAkCIKACEiAJAiCgAhIgCQIgoAISIAkCIKACEiAJAiCipAV2QA2UPQInrIxsGgBBRAAgRBYAQUQAIEQWAqLnf925BlgEgau4QZAsAEXMHIGsAiJiGDwRZAkC0tHisR10d4QxbdACIlhZQxVBhP8Z/wAAQLRxA7pNEBwwA0QJAjgAQLQ2gqiJu2XR6AGjbcWaebgFEB1SfZysagEi536uKB+gsggCIFA2IpgKAdhhn5ukA1QC0DACR0gDq/gWgec4OqKooQ/V+AGgRAKIIWgPoJIJODqgCIGHODagiA9I/7A8oN5ZnB0TbCMoKUD6Tr83pAZEE5QMou5NsABQd0DBMilkNQBvUJ6ezUxSg/M7SAhAB0LATRkIBQAA0CwC5A0ClAcpM0JkBKToAJAoApQOUYFYD0Bb1qQGgCAEgABIFgHIARB0ww6utASgMqL0csf85FSDakAC0SX1iehVBQcYCKD4gbQKAhOPcIbkAugBQhHFGrE4tnwiQMQQVEPkMKQBtUJ98unoVoPDsAyAAmiUTQMMN9xxtybMjoERfkApocLM7IOIZ0oEZcTtsmyuHdgWUZERlAeo78oh8jk0v14LDyZMA0Oe7mipff/nHeXxApE1uAJrldvmmfnj0P9jrJ7q0hbxBmhEg0pBnAfT5PrC5/fane5yp+tABIF22VEDPtx/9jw/HSuzSz2YAGpoLQH1oSyD6/gQ3ZQHioeAMWyygZhtIL4J820AANBsgPqBEmwiLMRFfY+T5pnYtHMuftIDok210ExI06WA8KqDxfQDijfO4gCbvBwY2F5aUzSXyoMcEZD5mE4DmbwPQkFvT9m4z6ObbC9M/xv6KxwXEWVrpTegyAd2+/Gw2g15qHyDOHxMv9KMDABQliXbjP9+bTWgASgSI0ohiAfUHEq+//bkDIPJROVNNOkCBodMCSnKUZDkq4mvkDAcSry8HATQ5DFQMoC4bPOEswTaQZvN8c52PN5etkQWdBBB13VgkoOFQ9Of7XoAoVQEoTnY5kMg6fsYsTa3aqOkfgwpAggAQAIlyLECM45MdIDWFjwuoSi/oxIDaiXtMQMO7AMSuTK5aGqBVdQGIXZlcVU9b/ShCX5IB4qyUAMisD0DLNwGIMc6SAVG3XwkDA9DacSYHRCh7DkDpBZ0V0DBp1fO8fQEg77iIr0UdZypAY7EwoH7KBgGZ/ZOFS8/epQPiwaQWBiBmYXJZAIoUAAptBAGQNyUAulOnAgDN38wO0EPfV/HDPQhhnDxA9ztVEADN38wL0PPt8qJ++nx3d95CGCcXEPWsMgPQUDEtIO/QZwP0/Nsv52+8cbIBEQUB0PzNrADFGycAWd6LB8h4D4BqBiCzVqguAEUKC9Dne7sN9PHq6HWDPE4+oGp2ONhR1/6zq+hYPQDIORZ/GwJDc1ZKxwD0fFMdbvT/rh7nOkBBQYUBms3bEwC69m6eb6JlEGdG1wagkCAAWryXFSBC32P8cYYBdUNU4XOeLEBV6YCI68asABF6P+SPkwKo0meVQ4IYgIzpGqC5WHcWBSi9IBagcQkEQIQ2BIY+HaD6+jL8tOkqrNL34OQBiHN6Ih6gxbslAvp4/TH7QT5OEqB2FgIQuXC2gPp+V2+u7ldXjDMIqPMDQMcApB+D8eJ8nz/OowPyDC0D5Bk+Y0Dxx5kKUKBwKkCc+TyftTyY8QARHlvtSRmA6lIALWdXCYAkgjiAHvK116J+CFDzvv6C4ZMZdEDmwcHDAZq8kROg9gqgq2j3y1Y/vLGSGFCgMAD5UwQg/RMAkQbPFlCSVRh9dykuoMkvuwBazNrjA4qVtYBCW9GrAfkKZwvIOTwAmckBkG80vsL+obcBRLiWc9NtINdv68cZD9CFXjcHQItBDw8o3m09k1/yBmTZQCoLUHgdtukqLM6NhZNfvIAqAHK+2b5k+0zWgKJkHaDgbtiskm/CHQSQ/fGeAGSkfEDOwcWAascDeQDIyBaAvIUBKJDMAZnfPhdAvsoA5HotZgDIOmgaQOH9+MwAqUvv2701547+VoB8B3dmQ+YOyPqeHdD8lcwAPd8uv/159VzS2gHq7hszbgPy1PcCqs4EyDcpHIBsb+QN6PHlZ4PDd2dq+56m47r98LiAbONMB8j+RtaA2ptTb57H6dYKkL5rw3X74WpA/iOJqwH5Bk0GyLJxewJA7aKlBeS5MzXdEii0CLICsn8CgMyW7LAE8txY2Gwk6Rs3nCu6bQHZPgJAZkt4gOY36toa5f602ga6+c+FNYa+/OxvIgvVTwZIzU3r1JnP56SAHN8wK0AcQbOhV+yFXVoekuQIyFWYC4jQLpVIgJbvzF8IXO6wNSBBLkOmr3o+sjsg6ztlAQoK2hKQ0UWQIABkH3RXQGREIkDOY4Os0AHRj9dYCtEBuTeCHIDcKzxKw1yD7gmIvhiSrcLCPUupvTAV8XEgKaAqCSD3Iqg8QNpOtRGgQYfH0ed7CBkA2QfdB1CvhwhoLi3BRrTqDNiTaX365TUARHgnvF8/SY6A6kfgkum1gLxnJ+yA7BNmB0CL58WUDWisGX8VFs7pALWPGyIc32Osp9xvbQDo3h2S6avb2hQqIuuk9WyA6u55VdXiTMtiuEIAtQtTISCju8012QiQEpQBoK5EOkDBA7O+KWzsw9MEVWpxKgQUr5/oaIAsZVyAlioKB3T3D+oHVLMOJbYLoEoOKF4/0YcC5ChDBcQ5ZeostRJQzQF0MS6lXQXo+ZbfKswDKMwFgGoqID2ylYD6vTDh03qmv20AKHT1RlpA3azhAFq02A9ocsYwb0Bxkh8gH4n8AdXbARqt9kWZS6Dv6kqgMjaih9kfH5C9HfEAzZqcHtB9W0AbbUQzrhx0Aer+pQCyVnZcx384QOpIVXJA1/E8u+yBc9Pf6IDc+88uQOrf2IBc7dgLkLERZBvS82k1mvudKKiKtQSSJQUga5VcAHUipgf8rLes7weodq2t54MLAcXJGQE1ZSaC7H0e6CG4gGo/IM/Hu9HoT3uP8+vBlyNiAur347faBgq94K+SF6AagLonzd1eYj4vLCmgfvjp3LDfaOEAZF+srwNkNtJewQEo5MeybWsra22Y0ZSwIDGg9l7BR3trc7QnFh4MkKN1BwTUF+UC+lF//PGr+299AChPQL6d3OUAqwC1t/W0e2IAZG3E/oAcQzoLbA2oO4J4/Vb8KswyYFJA/aXZYyvjAlqeorLWtbVrY0DtpWTNnthGVyTGAjSdHVYsdkFuQBxXdSmAgoIiAIqR7QAZi6Dx/GQEQI6GFAnIbEkAkO20P38bSB4A8q8EF5cHHgdQglub0wLSn5hcV7YjoLGZ2wJyvi4ApGsyV2HC+zFs9d1Tx3bhl7OmE5CeJQBkbxcH0PTtNYBS3BfmnjwxANUjoH6mJAPkmfx9mWSAlCD3gPZ3Zn7SA4qTTQF1n1kJyHUqjA9o0czIgGoAsmRLQNbSAGRp3awkF1Cwo3FCtgWkGQyAHKul0gG1gnzDWd/bHlC4o3FCACgfQNN2JAdE6GickI0B1fqCzRAg2wmOkgBZnz7nrzEH5P8K8xLd7/zjQIGOxgmRAHJccOCddgpQHROQ9XqwPQHVZQAidDROyNaA1H0r9xEQbWQ+QK41XijpANFHPWa+CZQeEK2j8VAOCij8aDcAStDR+CaAagNDFoCcR4b7Ve1GgOZNTg8oRrIEZJt2OwKajBiAvPUZgJxfMBUglx8AqlcC6lZhss45AMgDqLLdzx8FkKXKDoAe3ebPTbYRBEB5AFr68QJafH7Vbrza/Yq6G++5FGNbQJaxOQFZtMQAVO8MiHUse82BxATduzhb7dgvspcEIPK4x3EJnxgkWALFvCtjI0C9BjcK2/LcCcjSkjiAKv21jwlId0If90AiAJlF+irxAS3K7ACI8CgeQgDI095jA4oTASDXTCIB0ndBpQJE8EMBpL/iFoAsLT46INdcokxiRQeAxlEJAXWvMAEl6B8IgCbJFpDlHT6gz3fC7tfnewBZpoAWNbyAeAfh5uPwARpPyTtbtjKzFvIAOQbmbkSHd79ufQ+czgfHZwrIKKIeP7ELoL7QMQERbm02BnEdLcobUDdVTgHI1uDEgOqP30NnwYyFlOt4dXxAtCncFQwB6h5E0z4jLgDIuskUDAC9hjaid1kCUeYdCVB/kKtKBKj/rn4SwzUd0w+Jsz+g4PN0a+Mw9YbbQLEAqedgtYBaQQAUGDrNRnT4kT4SQPYjiXRAPhT9Y9RyAxTLz6yF3r7OQx8eBo6+EU2I9YDUMtEB1QEUI6DuaMzdD4h3MdY4DvMfdzvNMRO/XTj7AyJsRLsznkazNWQR+7omMaBhNO2yajdAs1ZGAzRtsrVs8lVYgu5dMgW02BIJjfTYgGzrgxVLoCjZF5DbxAyQ+a+jGr8RNEDTZsYDNJl6XED2gaMDIlzxsRugyv9QI6MZ+wO67wPI2bJYgMLdu3y+h9ZvEkCr70rXn/UBmgxamf9YkxJQfTeqRQRUB8smBkTp3iV4sGhZ39bq0gBRriejAwrP6RWhAHIfVLEPy9+ND3fv8ghc8XoQQLOWRAZkfKeYgMZirpsLkgJK0r1LvR2gKiYgymGVRU4OKEn3LjULkPWbUCcxAI3VmP0MxAGUpHuXGoD81aMBmiyC9gGUonuXelNAfhPjkIcF1JfjAbIPvQJQjMgA2WYUGVAVMDEZsmYBorUhC0B3VTV8ZabZmqwB2drM6SUegGjpb+5W/+cBcgzJABTnSSv2+gDkru6e0+zor9OW9lQFIGfogPRgRwV091a1zg3HgADkGTQwbLGA6rMAsn/cshUNQLQMK+b73ddcBqCKBShGzwr2+ssmuw/YANDqEAFZZ4d1wPs92yUQq3s5ACJGPXav6zYbgLyv2FMoIEphWqpOEACFX7EnNqBq8hulLB2Qcc6BUpgWA5B3uHn73P0Clgho3V3F3ScBSAMKTAUqIMcpsnWNI8eKdv5iAYCmkzUBoPGwX6xUY7zDAZDjk4UBMs48xIle/tQANB+YOOqqKguQeQFPjABQl3X39HWfjA2oMn4h1R1ufg2mv/QEgCj1AchSfXYRaoToo0DxAOVyOcd2gIh+SIAm0zU6IL0IinkcsUuPyBcAcn0SgLoA0Hxg4qgBSCU4FWYNPBog1sOGp5+MDagafybVzQNQMNMG+nrlIr4WM6cGpL4pFVA9PHxl4ywAOQckvhYz1vqWta57wmUIiNyE7oZy0iQGIMY4twNEHrImbCqMUxaA/K/FDAXQndU72DEBqYkAQLT6PEAzQXsCqphNACBxzg7I0kukq3q3sAUgUv15kwsB1A9DP+FQCCCzjQA0fjAuoHERxDhjxQK003Eg3cj2f/5jUWUCmm9Fc06mcoakAKrZV+1Q/ewKqD9edVEXwBYBaLrQ9AMi9FgrS0W7+KxvJ61vDm7aokkKU6K29osCNL04gg4o2flGACoI0OLU5M6AaNcO9RftAFDgtZjxADLPLHnn3gaAaOc9dEOTAdrNTw/oUnn3BIsFZM4xAEqSy6UwQCYEANLFAYhRPzNApKNGeiMIgAKvxQwNUGDm5QJIUQ/eK7wygV400qZ/fGw5gIw/tzCgajJwjHZZxkEY6OCA9J4gACWLWocdF1BgPZoXoHE2AJAuviOgugfka0RegOpiASXa2M0BkL8RACSOaseBAdUFARpUhJ9pcQpA3nmXPCMgzzDE12ImEqDJBlOUhq2LvugiVfEMAHmHIb4WMz5AvQoA6ovvCogwDPG1mDkYoKTnzHcFREl2gIZNijCg2ljfxWrbmgAQ4TVy1AN5H77OyAGIU/uUgNrHYrp7dfXV71mEARnrsEMDSlM3WpIA0nRujierBgHdAaiYJAH08doBmj3beXzShu/zehFEAlSPW9ySJouz71UX+ya3JVCtewUkmGBsLyUOAIVfI0c90+el7jenufUVoDsNEHl7KW0AKPwaJ42hLz+bHTGHn0D9XlBBgHY+ZbVrMjsOVOuruGiA6HtsiQNAwddSj3OMBkQw0S+CAGjHZAqIdjkpfY8tcQAo+FrqcY4pEVD+B4yTpWhAWhAA7RgAihIACr2WepxGlAaaiaq6XABozxQPqBEEQDsGgKIEgEKvpR6nEQ6gthoA7RkAipLT+gEgRJYsAZG6txzLXQBov2QIqAaggpIjIFr3lmM5ANoxAISIkiUgWu+EQ7nLzpdEnzqHAIQF0H7JExDjoSjIvgEgRJRsASVuAxIpmQJCSgkAIaIAECIKACGiABAiCgAhogAQIgoAIaLsAgg5UHYAFCWpGpnsy5+owQBUUuEMGwxAJRXOsMEAVFLhDBsMQCUVzrDBAFRS4QwbDEAlFc6wwQBUUuEMGwxAJRXOsMEAVFLhDBtcBCAk3wAQIgoAIaIAECIKACGiABAiCgAhogAQIgoAIaIAECIKACGiABAiCgAhouQE6PNdP/z5cbE/hf5xaR8R3f7T5UfkunV963+IVLiuP/74Nfshat1UDR4f6B5KZoDU17rav96jfcB4P72eb5Svx6t7bf738Up1GS7ctvLrr+kPUevemv8/GILIhT9+pxbNC9Bfvrftfv7t77av9/ne/vVctZsbfYZQ6z7f2h9urr9NduFu0aaaOfwQtW7X4M938l8SvcEPcmvzAvRybWfh47d/tV/vqtZSz+//Vl9KLRs0nI/Xb9Hrqr9lxl90oHAzO76pOTH8ELmuHjh+4Ru5ZmaAHt33+nZt/mkXNbdmZj7f9B+LWqzqKXflzQ9SXQ2IvG0VKlzXxp8yExC5bvdW9MLXvza2SH+imQFqN+Ge3382X+/ZLmvbhYNasdT9okH9f3gxZl29KGIB8hXuiq8ERK37IM5nXmFF6kqpnBmgz/cfzfL1z6v6k3i0S9jnm56hJiDOliO9rtqIZgHyFe5eWQmIXLcZmLPRxihMa3JmgNqVbwO//XrNHurX/7waX89chV3pE41Tt9ko+Prf75xtIF/hul4PiFyXu9HGKEzaIc0N0Mcf//vnz/brda3/mMzocSOatQZj1O1+pR+wCRRusxoQtS5xPq8qTNmXzw3Q5/s/mhnYfL3uizzMBayxG885WMOp24a1G+8t3GY1IEpdNRkYlRMUzg1QsxZ5qfu/j+dbs4U4fr3xQCJrE4hctzs2yTsu5y9cCwCR6rYrIuU/duH2z6nEjWi9F63X0F9+Npu1xtcbDtwzjiJy6rYH8Jlb5/7CEkCkulfGGZ00hXMChBQYAEJEASBEFABCRAEgRBQAQkQBIEQUAEJEASBEFABCRAEgRBQAQkQBIEQUAEJEASBEFABCRAEgRBQAQkQBIEQUAEJEASBEFABCRAEgRBQAQkQBIEQUAEJEAaBVudr6iX1wenw4SgBoVVT/RB+vZleCk1vMTxMAWpW+gy+zKwYAQsjRgFQPqaoni4/Xy0V1ecHptbD4ANCq9F3sTTs7/aF+4HRBXHwAaFV6QLevv4zOTvsOTzl9AZUeAFoVA1D7z9DZqdoo4vXAV3YAaFXMVZjZ2Sn3OTDlB4BWxdiInnR2yuu88QgBoFUxduMnnZ2eb1cegFalP5D4rV/4dJ2dftNPrrieaDkEQKtinsroOztVD+FqjwOdaCcMgBBZAAgRBYAQUQAIEQWAEFEACBEFgBBRAAgRBYAQUQAIEQWAEFEACBEFgBBRAAgRBYAQUQAIEQWAEFEACBEFgBBRAAgRBYAQUQAIEQWAEFH+D3m14DYUJEDKAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
<p>This illustration shows that the <code>interpolate_gaps_hourly</code>
function produced a pretty good approximation (red lines) to the actual
temperatures (gray line).</p>
</div>
<div id="accuracy-assessment" class="section level2">
<h2>Accuracy assessment</h2>
<p>Since the actual hourly temperatures are known, we can evaluate the
accuracy of the predictions produced by the various interpolation
methods. A common measure for validating predictions is the Root Mean
Square Error of the Prediction (RMSEP):</p>
<p><span class="math display">\[RMSEP=\sqrt{\frac{\sum_{i=1}^n(\hat{y}_i-y_i)^2}{n}}\]</span>,
with <span class="math inline">\(\hat{y}_i\)</span> being the observed
values and <span class="math inline">\(y_i\)</span> the predicted
values.</p>
<p>The RMSEP provides an indication of how far each predicted value
deviates, on average, from the actual values. It is, however, quite
difficult to interpret RMSEP values alone, because whether they indicate
a good or poor model fit depends on how variable the actual values are.
For instance, an RMSEP of 5 days for a phenology model (which is close
to, but not quite the same as a mean error of 5 days), could indicate a
very good model, if observed dates vary by several weeks or months
(e.g. for bloom dates of deciduous trees), but a terrible model, if the
phenological stage of interest occurs on the same day every year
(e.g. the ‘phenological’ event of candles lighting up on ‘festive indoor
conifers’).</p>
<p>This is why it makes sense to include in such accuracy assessment the
variation in observed values. This can be achieved by dividing the
standard deviation of the observed data by the RMSEP to calculate the
Residual Prediction Deviation (RPD):</p>
<p><span class="math display">\[RPD=\frac{sd_y}{RMSEP}\]</span> <span class="math inline">\(\hat{y}_i\)</span> are the observed values, <span class="math inline">\(y_i\)</span> the predicted values, and</p>
<p><span class="math display">\[sd_y=\sqrt{\frac{\sum_{i=1}^n(y_i-\bar{y})^2}{n-1}}\]</span></p>
<p>is the standard deviation, with <span class="math inline">\(\bar{y}\)</span> being the mean over all
observations.</p>
<p>The RPD is more useful than the RMSEP, but its use of the standard
deviation can be a problem, when actual values of <span class="math inline">\(y\)</span> aren’t normally distributed (then the
standard deviation can be a poor measure of variation). A more robust
approach is use the interquartile range instead of the standard
deviation. This metric is called the Ratio of Performance to
InterQuartile distance (RPIQ):</p>
<p><span class="math display">\[RPIQ=\frac{IQ}{RMSEP}\]</span></p>
<p>IQ is calculated by subtracting the 75<sup>th</sup> percentile of the
distribution of all <span class="math inline">\(y\)</span> from the
25<sup>th</sup> percentile.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">require</span>(stats)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>IQ<span class="ot">&lt;-</span><span class="fu">quantile</span>(y)[<span class="dv">4</span>]<span class="sc">-</span><span class="fu">quantile</span>(<span class="dv">2</span>)[<span class="dv">2</span>]</span></code></pre></div>
<p>The RPIQ score is a bit harder to evaluate than the RMSEP, with
different quality thresholds in use and a very high context dependency.
Quite commonly, values above 2 are considered ‘good’ or even
‘excellent’, though some studies use substantially higher thresholds (up
to 8 for excellence).</p>
<p>Since the RPIQ makes no assumption about the distribution of <span class="math inline">\(y\)</span>, let’s use this for assessing the
accuracy of the various interpolation methods. We have a total of four
methods to evaluate:</p>
<ul>
<li><strong>idealized</strong> temperature curves from
<strong>daily</strong> records of Tmin and Tmax, based on records from a
nearby weather station</li>
<li><strong>idealized</strong> temperature curves from
<strong>daily</strong> records of Tmin and Tmax, based on records from
<strong>the same location</strong><br />
</li>
<li><strong>linear</strong> interpolation of <strong>hourly</strong>
temperatures</li>
<li>interpolation of <strong>hourly</strong> temperatures with
<strong>interpolate_gaps_hourly</strong></li>
</ul>
<p>For option 2, we first have to generate a dataset of daily minimum
and maximum temperatures from the hourly records. We can do this with
the <code>make_all_day_table</code> function (see documentation for this
function for details).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>orchard_extremes<span class="ot">&lt;-</span><span class="fu">make_all_day_table</span>(inter,<span class="at">timestep=</span><span class="st">&quot;day&quot;</span>,</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>                                     <span class="at">input_timestep =</span> <span class="st">&quot;hour&quot;</span>)</span></code></pre></div>
<p>Let’s first look at the performance of the four methods for the
periods that were missing in the hourly temperature record:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>winters_hours<span class="ot">&lt;-</span><span class="fu">stack_hourly_temps</span>(<span class="fu">fix_weather</span>(winters_daily),<span class="at">latitude=</span><span class="dv">38</span>)<span class="sc">$</span>hourtemps</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>start_hour_winters<span class="ot">&lt;-</span><span class="fu">which</span>(winters_hours<span class="sc">$</span>Year<span class="sc">==</span>inter<span class="sc">$</span>Year[<span class="dv">1</span>]<span class="sc">&amp;</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>                    winters_hours<span class="sc">$</span>Month<span class="sc">==</span>inter<span class="sc">$</span>Month[<span class="dv">1</span>]<span class="sc">&amp;</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>                    winters_hours<span class="sc">$</span>Day<span class="sc">==</span>inter<span class="sc">$</span>Day[<span class="dv">1</span>]<span class="sc">&amp;</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>                    winters_hours<span class="sc">$</span>Hour<span class="sc">==</span>inter<span class="sc">$</span>Hour[<span class="dv">1</span>])</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>end_hour_winters<span class="ot">&lt;-</span><span class="fu">which</span>(winters_hours<span class="sc">$</span>Year<span class="sc">==</span>inter<span class="sc">$</span>Year[<span class="fu">nrow</span>(inter)]<span class="sc">&amp;</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>                    winters_hours<span class="sc">$</span>Month<span class="sc">==</span>inter<span class="sc">$</span>Month[<span class="fu">nrow</span>(inter)]<span class="sc">&amp;</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>                    winters_hours<span class="sc">$</span>Day<span class="sc">==</span>inter<span class="sc">$</span>Day[<span class="fu">nrow</span>(inter)]<span class="sc">&amp;</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>                    winters_hours<span class="sc">$</span>Hour<span class="sc">==</span>inter<span class="sc">$</span>Hour[<span class="fu">nrow</span>(inter)])</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>orchard_hours<span class="ot">&lt;-</span><span class="fu">stack_hourly_temps</span>(orchard_extremes,<span class="at">latitude=</span><span class="dv">38</span>)<span class="sc">$</span>hourtemps</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>start_hour_orchard<span class="ot">&lt;-</span><span class="fu">which</span>(orchard_hours<span class="sc">$</span>Year<span class="sc">==</span>inter<span class="sc">$</span>Year[<span class="dv">1</span>]<span class="sc">&amp;</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>                    orchard_hours<span class="sc">$</span>Month<span class="sc">==</span>inter<span class="sc">$</span>Month[<span class="dv">1</span>]<span class="sc">&amp;</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>                    orchard_hours<span class="sc">$</span>Day<span class="sc">==</span>inter<span class="sc">$</span>Day[<span class="dv">1</span>]<span class="sc">&amp;</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>                    orchard_hours<span class="sc">$</span>Hour<span class="sc">==</span>inter<span class="sc">$</span>Hour[<span class="dv">1</span>])</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>end_hour_orchard<span class="ot">&lt;-</span><span class="fu">which</span>(orchard_hours<span class="sc">$</span>Year<span class="sc">==</span>inter<span class="sc">$</span>Year[<span class="fu">nrow</span>(inter)]<span class="sc">&amp;</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>                    orchard_hours<span class="sc">$</span>Month<span class="sc">==</span>inter<span class="sc">$</span>Month[<span class="fu">nrow</span>(inter)]<span class="sc">&amp;</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>                    orchard_hours<span class="sc">$</span>Day<span class="sc">==</span>inter<span class="sc">$</span>Day[<span class="fu">nrow</span>(inter)]<span class="sc">&amp;</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a>                    orchard_hours<span class="sc">$</span>Hour<span class="sc">==</span>inter<span class="sc">$</span>Hour[<span class="fu">nrow</span>(inter)])</span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a>observed<span class="ot">&lt;-</span>inter<span class="sc">$</span>Temp_recorded</span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a>option1<span class="ot">&lt;-</span>winters_hours<span class="sc">$</span>Temp[start_hour_winters<span class="sc">:</span>end_hour_winters]</span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a>option2<span class="ot">&lt;-</span>orchard_hours<span class="sc">$</span>Temp[start_hour_orchard<span class="sc">:</span>end_hour_orchard]</span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a>option3<span class="ot">&lt;-</span><span class="fu">interpolate_gaps</span>(inter<span class="sc">$</span>Temp_gaps)<span class="sc">$</span>interp</span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a>option4<span class="ot">&lt;-</span>inter<span class="sc">$</span>Temp</span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a>eval_table<span class="ot">&lt;-</span>eval_table_gaps<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Option=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a>                <span class="at">Input_data=</span><span class="fu">c</span>(<span class="st">&quot;daily&quot;</span>,<span class="st">&quot;daily&quot;</span>,<span class="st">&quot;hourly&quot;</span>,<span class="st">&quot;hourly&quot;</span>),</span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a>                <span class="at">Interpolation_method=</span><span class="fu">c</span>(<span class="st">&quot;from proxy&quot;</span>,<span class="st">&quot;local extremes&quot;</span>,</span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a>                                <span class="st">&quot;linear&quot;</span>,<span class="st">&quot;hourly interpolation&quot;</span>),</span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a>                <span class="at">RMSEP=</span><span class="cn">NA</span>,<span class="at">RPIQ=</span><span class="cn">NA</span>)</span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a></span>
<span id="cb15-33"><a href="#cb15-33" tabindex="-1"></a>observed_gaps<span class="ot">&lt;-</span>observed[<span class="fu">which</span>(<span class="fu">is.na</span>(inter<span class="sc">$</span>Temp_gaps))]</span>
<span id="cb15-34"><a href="#cb15-34" tabindex="-1"></a>option1_gaps<span class="ot">&lt;-</span>option1[<span class="fu">which</span>(<span class="fu">is.na</span>(inter<span class="sc">$</span>Temp_gaps))]</span>
<span id="cb15-35"><a href="#cb15-35" tabindex="-1"></a>option2_gaps<span class="ot">&lt;-</span>option2[<span class="fu">which</span>(<span class="fu">is.na</span>(inter<span class="sc">$</span>Temp_gaps))]</span>
<span id="cb15-36"><a href="#cb15-36" tabindex="-1"></a>option3_gaps<span class="ot">&lt;-</span>option3[<span class="fu">which</span>(<span class="fu">is.na</span>(inter<span class="sc">$</span>Temp_gaps))]</span>
<span id="cb15-37"><a href="#cb15-37" tabindex="-1"></a>option4_gaps<span class="ot">&lt;-</span>option4[<span class="fu">which</span>(<span class="fu">is.na</span>(inter<span class="sc">$</span>Temp_gaps))]</span>
<span id="cb15-38"><a href="#cb15-38" tabindex="-1"></a></span>
<span id="cb15-39"><a href="#cb15-39" tabindex="-1"></a>eval_table_gaps[,<span class="st">&quot;RMSEP&quot;</span>]<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">RMSEP</span>(option1_gaps,observed_gaps),</span>
<span id="cb15-40"><a href="#cb15-40" tabindex="-1"></a>                             <span class="fu">RMSEP</span>(option2_gaps,observed_gaps),</span>
<span id="cb15-41"><a href="#cb15-41" tabindex="-1"></a>                             <span class="fu">RMSEP</span>(option3_gaps,observed_gaps),</span>
<span id="cb15-42"><a href="#cb15-42" tabindex="-1"></a>                             <span class="fu">RMSEP</span>(option4_gaps,observed_gaps)),<span class="dv">1</span>)</span>
<span id="cb15-43"><a href="#cb15-43" tabindex="-1"></a></span>
<span id="cb15-44"><a href="#cb15-44" tabindex="-1"></a>eval_table_gaps[,<span class="st">&quot;RPIQ&quot;</span>]<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">RPIQ</span>(option1_gaps,observed_gaps),</span>
<span id="cb15-45"><a href="#cb15-45" tabindex="-1"></a>                            <span class="fu">RPIQ</span>(option2_gaps,observed_gaps),</span>
<span id="cb15-46"><a href="#cb15-46" tabindex="-1"></a>                            <span class="fu">RPIQ</span>(option3_gaps,observed_gaps),</span>
<span id="cb15-47"><a href="#cb15-47" tabindex="-1"></a>                            <span class="fu">RPIQ</span>(option4_gaps,observed_gaps)),<span class="dv">1</span>)</span>
<span id="cb15-48"><a href="#cb15-48" tabindex="-1"></a></span>
<span id="cb15-49"><a href="#cb15-49" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(eval_table_gaps,<span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Option</th>
<th align="left">Input_data</th>
<th align="left">Interpolation_method</th>
<th align="right">RMSEP</th>
<th align="right">RPIQ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">daily</td>
<td align="left">from proxy</td>
<td align="right">2.6</td>
<td align="right">4.1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">daily</td>
<td align="left">local extremes</td>
<td align="right">2.1</td>
<td align="right">5.0</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">hourly</td>
<td align="left">linear</td>
<td align="right">5.3</td>
<td align="right">2.0</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">hourly</td>
<td align="left">hourly interpolation</td>
<td align="right">2.0</td>
<td align="right">5.4</td>
</tr>
</tbody>
</table>
<p>This table shows that the <code>interpolate_gaps_hourly</code>
function produced the best results, with an RMSEP of 2 and an RPIQ of
5.4. It’s interesting to note that option 3, where hourly records
collected in the orchard were interpolated linearly, produced the worst
fit. This highlights that, at least in this case, using an idealized
temperature curve to close gaps in daily temperatures from the orchard
(option 2) and even from the proxy station (option 1) produced more
accurate results. Naturally, the quality of the latter approach will
depend on the similarity between weather at the proxy station and in the
orchard (in this case, this should be quite similar).</p>
<p>Restricting the comparison to only the gaps in the record is a bit
unfair, because of course option 3 (linear interpolation of hourly
records from the orchard) are completely accurate for hours, when
temperatures were recorded. So let’s also compare the relative
performance of the four methods across all hours of the record.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>eval_table<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Option=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>                  <span class="at">Input_data=</span><span class="fu">c</span>(<span class="st">&quot;daily&quot;</span>,<span class="st">&quot;daily&quot;</span>,<span class="st">&quot;hourly&quot;</span>,<span class="st">&quot;hourly&quot;</span>),</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>                  <span class="at">Interpolation_method=</span><span class="fu">c</span>(<span class="st">&quot;from proxy&quot;</span>,<span class="st">&quot;local extremes&quot;</span>,</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>                                    <span class="st">&quot;linear&quot;</span>,<span class="st">&quot;hourly interpolation&quot;</span>),</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>                  <span class="at">RMSEP=</span><span class="cn">NA</span>,<span class="at">RPIQ=</span><span class="cn">NA</span>)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>eval_table[,<span class="st">&quot;RMSEP&quot;</span>]<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">RMSEP</span>(option1,observed),<span class="fu">RMSEP</span>(option2,observed),</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>                       <span class="fu">RMSEP</span>(option3,observed),<span class="fu">RMSEP</span>(option4,observed)),<span class="dv">1</span>)</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>eval_table[,<span class="st">&quot;RPIQ&quot;</span>]<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">RPIQ</span>(option1,observed),<span class="fu">RPIQ</span>(option2,observed),</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>                       <span class="fu">RPIQ</span>(option3,observed),<span class="fu">RPIQ</span>(option4,observed)),<span class="dv">1</span>)</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(eval_table,<span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Option</th>
<th align="left">Input_data</th>
<th align="left">Interpolation_method</th>
<th align="right">RMSEP</th>
<th align="right">RPIQ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">daily</td>
<td align="left">from proxy</td>
<td align="right">2.5</td>
<td align="right">4.2</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">daily</td>
<td align="left">local extremes</td>
<td align="right">1.9</td>
<td align="right">5.7</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">hourly</td>
<td align="left">linear</td>
<td align="right">3.9</td>
<td align="right">2.7</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">hourly</td>
<td align="left">hourly interpolation</td>
<td align="right">1.5</td>
<td align="right">7.2</td>
</tr>
</tbody>
</table>
<p>The relative performance of the methods on the whole dataset is quite
similar to the previous assessment. The quality of the proxy-based
idealized temperature curves went down slightly, while all other
approaches saw improvements in quality (lower RMSEP and higher RPIQ).
The RPIQ values for the two interpolations that were based on local data
(options 2 and 4) are very high, especially for option 4, which used the
<code>interpolate_gaps_hourly</code> function. The RPIQ score for this
option almost exceeds the ‘excellence’ threshold for the most
conservative RPIQ evaluation scheme that I’ve come across (8). I find
this quite remarkable, given the variable nature of daily temperature
fluctuations and the fact that about half of the actually recorded
values were removed before running the interpolation.</p>
<p><strong><em>In conclusion, the <code>interpolate_gaps_hourly</code>
function provided a very good approximation of hourly temperatures for
times, when no values were recorded.</em></strong></p>
</div>
<div id="computing-agroclimatic-metrics" class="section level2">
<h2>Computing agroclimatic metrics</h2>
<p>Finally, let’s look at the implication of the choice of interpolation
method on chill and heat estimates. If we’re interested in using the
Dynamic Model for winter chill or the Growing Degree Hours model for
heat, we can simply calculate this using the <code>Dynamic_Model</code>
and <code>GDH</code> functions in <code>chillR</code>. For more
functionality, see the <code>chilling</code> and particularly the
<code>tempResponse</code> functions.</p>
<p>Let’s first look at the implications of method choice on chill
accumulation:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>option1_chill<span class="ot">&lt;-</span><span class="fu">Dynamic_Model</span>(option1)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>option2_chill<span class="ot">&lt;-</span><span class="fu">Dynamic_Model</span>(option2)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>option3_chill<span class="ot">&lt;-</span><span class="fu">Dynamic_Model</span>(option3)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>option4_chill<span class="ot">&lt;-</span><span class="fu">Dynamic_Model</span>(option4)</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>observed_chill<span class="ot">&lt;-</span><span class="fu">Dynamic_Model</span>(observed)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>This figure shows that the chill accumulation differed substantially
between the options. Both the use of proxy data and the use of linear
interpolation of hourly temperatures led to substantial overestimation
of chill accumulation.</p>
<p>Here is the same assessment for heat:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>option1_heat<span class="ot">&lt;-</span><span class="fu">GDH</span>(option1)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>option2_heat<span class="ot">&lt;-</span><span class="fu">GDH</span>(option2)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>option3_heat<span class="ot">&lt;-</span><span class="fu">GDH</span>(option3)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>option4_heat<span class="ot">&lt;-</span><span class="fu">GDH</span>(option4)</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>observed_heat<span class="ot">&lt;-</span><span class="fu">GDH</span>(observed)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>This comparison doesn’t look quite as bad as for chill accumulation,
but also here, option 4 clearly provided the most accurate estimate (it
almost coincides with the black line, making the difference hard to
see).</p>
<p>This dataset didn’t cover the winter season, so the chill numbers
aren’t too meaningful, but it is nevertheless instructive to compare the
total accumulation of chill and heat over the whole temperature
record:</p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="28%" />
<col width="20%" />
<col width="28%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Option</th>
<th align="left">Input_data</th>
<th align="left">Interpolation_method</th>
<th align="right">Chill Portions</th>
<th align="right">Growing Degree Hours</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="left">observed</td>
<td align="left">none</td>
<td align="right">12.2</td>
<td align="right">72925</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">daily</td>
<td align="left">from proxy</td>
<td align="right">20.1</td>
<td align="right">64813</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">daily</td>
<td align="left">local extremes</td>
<td align="right">13.8</td>
<td align="right">70974</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">hourly</td>
<td align="left">linear</td>
<td align="right">23.1</td>
<td align="right">78256</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">hourly</td>
<td align="left">hourly interpolation</td>
<td align="right">13.6</td>
<td align="right">72610</td>
</tr>
</tbody>
</table>
<p>This comparison shows that the choice of interpolation method can
have substantial impact on our impression of accumulated chill and heat.
The <code>interpolate_gaps_hourly</code> function in <code>chillR</code>
outperformed all other methods evaluated here.</p>
<div id="references" class="section level4 unnumbered">
<h4 class="unnumbered">References</h4>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Almoroxetal2005" class="csl-entry">
Almorox, J., Hontoria, C., Benito, M., 2005. Statistical validation of
daylength definitions for estimation of global solar radiation in
toledo, spain. Energy Conversion and Management 46, 1465–1471. <a href="https://doi.org/10.1016/j.enconman.2004.07.007">https://doi.org/10.1016/j.enconman.2004.07.007</a>
</div>
<div id="ref-Andersonetal1986" class="csl-entry">
Anderson, J.L., Richardson, E.A., Kesner, C.D., 1986. <span class="nocase">Validation of chill unit and flower bud phenology models
for ’Montmorency’ sour cherry</span>. Acta Horticulturae (ISHS) 184,
71–78. <a href="https://doi.org/10.17660/ActaHortic.1986.184.7">https://doi.org/10.17660/ActaHortic.1986.184.7</a>
</div>
<div id="ref-Bennett1949" class="csl-entry">
Bennett, J.P., 1949. <span class="nocase">Temperature and bud rest
period</span>. California Agriculture 3, 9, 12.
</div>
<div id="ref-CrossaRaynaud1955" class="csl-entry">
Crossa-Raynaud, P., 1955. <span class="nocase">Effets des hivers doux
sur le comportement des arbres fruitiers <span class="nocase">à</span>
feuilles caduques: Observations faites en Tunisie <span class="nocase">à</span> la suite de l’hiver 1954-1955</span>. Impr. La
Rapide.
</div>
<div id="ref-Erezetal1990" class="csl-entry">
Erez, A., Fishman, S., Linsley-Noakes, G.C., Allan, P., 1990. <span class="nocase">The dynamic model for rest completion in peach
buds</span>. Acta Horticulturae 276, 165–174. <a href="https://doi.org/10.17660/ActaHortic.1990.276.18">https://doi.org/10.17660/ActaHortic.1990.276.18</a>
</div>
<div id="ref-Linvill1990" class="csl-entry">
Linvill, D.E., 1990. <span class="nocase">Calculating chilling hours and
chill units from daily maximum and minimum temperature
observations</span>. HortScience 25, 14–16.
</div>
<div id="ref-LuedelingBrown2011" class="csl-entry">
Luedeling, E., Brown, P.H., 2011. <span class="nocase">A global analysis
of the comparability of winter chill models for fruit and nut
trees</span>. International Journal of Biometeorology 55, 411–421. <a href="https://doi.org/10.1007/s00484-010-0352-y">https://doi.org/10.1007/s00484-010-0352-y</a>
</div>
<div id="ref-Richardsonetal1974" class="csl-entry">
Richardson, E.A., Seeley, S.D., Walker, D.R., 1974. <span class="nocase">A model for estimating the completion of rest for
Redhaven and Elberta peach trees</span>. HortScience 9, 331–332.
</div>
<div id="ref-Spencer1971" class="csl-entry">
Spencer, J.W., 1971. <span class="nocase">Fourier series representation
of the position of the Sun</span>. Search 2, 172.
</div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
