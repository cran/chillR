<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Carsten Urbach, Eike Luedeling, Katja Schiffers" />

<meta name="date" content="2024-11-14" />

<title>PhenoFlex</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">PhenoFlex</h1>
<h4 class="author">Carsten Urbach, Eike Luedeling, Katja Schiffers</h4>
<h4 class="date">2024-11-14</h4>



<div id="the-phenoflex-model" class="section level1">
<h1>The <code>PhenoFlex</code> Model</h1>
<p>The <code>PhenoFlex</code> Model constitutes a framework for modeling
the spring phenology of deciduous trees, with a particular focus on
fruit and nut trees. It uses the structure of the Dynamic Model for
chill accumulation and the Growing Degree Hours model for heat
accumulation. In order to relate spring phenology to chill and heat, and
to account for varying theories about the relationship between these two
agroclimatic phenomena, <code>PhenoFlex</code> includes a flexible
transition function that defines responsiveness to heat (during
ecodormancy) as a function of accumulated chill (during endodormancy).
Unlike most previous applications of these models,
<code>PhenoFlex</code> can flexibly fit the parameters of both models to
observed spring phenology dates. The model can thus accommodate
variation among the temperature responses of different species and
cultivars.</p>
<p>The <code>PhenoFlex</code> Model is implemented in the
<code>chillR</code> package, which also contains functions to fit the
model parameters to observed spring phenology data. This vignette
demonstrates the use of the PhenoFlex Model to predict spring phenology
dates, as well as the procedure for fitting model parameters to
data.</p>
<div id="data-preparation" class="section level2">
<h2>Data preparation</h2>
<p>We demonstrate the <code>PhenoFlex</code> functions using the example
of cherry bloom data recorded at Campus Klein-Altendorf, the
experimental station of the University of Bonn. This dataset, along with
long-term records of daily minimum and maximum temperatures, is included
in the <code>chillR</code> package (<code>KA_bloom</code> and
<code>KA_weather</code>, respectively). Since the PhenoFlex model
requires hourly temperatures, we use the <code>stack_hourly_temps</code>
function from <code>chillR</code> to interpolate the daily data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(chillR)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">data</span>(KA_weather)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">data</span>(KA_bloom)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>hourtemps <span class="ot">&lt;-</span> <span class="fu">stack_hourly_temps</span>(KA_weather, <span class="at">latitude=</span><span class="fl">50.4</span>)</span></code></pre></div>
<p>In <code>PhenoFlex</code>, the chilling requirement is denoted <span class="math inline">\(y_c\)</span> and the heat requirement <span class="math inline">\(z_c\)</span>. We first illustrate how the model
can be used to predict spring phenology events, based on user-specified
<span class="math inline">\(y_c\)</span> and <span class="math inline">\(z_c\)</span> values and using the usual parameters
for the Dynamic Model and the Growing Degree Hours model (the default
values in <code>PhenoFlex</code>). To run the analysis for one year
only, we select all data for the 2009 season. The 2009 season is the
dormancy season that ends in 2009. The number of months to consider for
the season is specified in the <code>genSeason</code> function by the
<code>mrange</code> parameter. Since the default (August to June) is
appropriate here, this is not specified below.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>yc <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>zc <span class="ot">&lt;-</span> <span class="dv">190</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>iSeason <span class="ot">&lt;-</span> <span class="fu">genSeason</span>(hourtemps, <span class="at">years=</span><span class="fu">c</span>(<span class="dv">2009</span>))</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">PhenoFlex</span>(<span class="at">temp=</span>hourtemps<span class="sc">$</span>hourtemps<span class="sc">$</span>Temp[iSeason[[<span class="dv">1</span>]]],</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>                 <span class="at">times=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span> <span class="fu">length</span>(hourtemps<span class="sc">$</span>hourtemps<span class="sc">$</span>Temp[iSeason[[<span class="dv">1</span>]]])),</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>                 <span class="at">zc=</span>zc, <span class="at">stopatzc=</span><span class="cn">TRUE</span>, <span class="at">yc=</span>yc, <span class="at">basic_output=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p>The PhenoFlex function generates a list that tracks the accumulation
of x (precursor to the dormancy-breaking factor), y (the
dormancy-breaking factor; or Chill Portion), z (heat accumulation) and
xs (the ratio of the formation to the destruction rate of x) over time.
It also returns a bloomindex element, which points to the row in the
temps input table that corresponds to estimated budbreak (or whatever
the phenological stage of interest is).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>DBreakDay <span class="ot">&lt;-</span> res<span class="sc">$</span>bloomindex</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>seasontemps<span class="ot">&lt;-</span>hourtemps<span class="sc">$</span>hourtemps[iSeason[[<span class="dv">1</span>]],]</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>seasontemps[,<span class="st">&quot;x&quot;</span>]<span class="ot">&lt;-</span>res<span class="sc">$</span>x</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>seasontemps[,<span class="st">&quot;y&quot;</span>]<span class="ot">&lt;-</span>res<span class="sc">$</span>y</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>seasontemps[,<span class="st">&quot;z&quot;</span>]<span class="ot">&lt;-</span>res<span class="sc">$</span>z</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>seasontemps<span class="ot">&lt;-</span><span class="fu">add_date</span>(seasontemps)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>seasontemps[<span class="dv">1</span><span class="sc">:</span>DBreakDay,],<span class="fu">aes</span>(<span class="at">x=</span>Date,<span class="at">y=</span>y)) <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">lwd=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span>yc,<span class="at">lty=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Chill (y) accumulation&quot;</span>)</span></code></pre></div>
<div class="float">
<img role="img" aria-label="Chill accumulation over time. The dashed line respresents y_c, the critical amount of chill units for ecodormancy to be broken." src="data:image/png;base64,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" alt="Chill accumulation over time. The dashed line respresents y_c, the critical amount of chill units for ecodormancy to be broken." />
<div class="figcaption">Chill accumulation over time. The dashed line
respresents <span class="math inline">\(y_c\)</span>, the critical
amount of chill units for ecodormancy to be broken.</div>
</div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>seasontemps[<span class="dv">1</span><span class="sc">:</span>DBreakDay,],<span class="fu">aes</span>(<span class="at">x=</span>Date,<span class="at">y=</span>z)) <span class="sc">+</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lwd=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span>zc,<span class="at">lty=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Heat (z) accumulation&quot;</span>)</span></code></pre></div>
<div class="float">
<img role="img" aria-label="Heat accumulation over time. The dashed line respresents the z_c, the critical amount of heat units for ecodormancy to be broken." src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAABblBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYzMzM6AAA6OgA6Ojo6OmY6ZmY6ZpA6ZrY6kLY6kNtNTU1NTW5NTY5Nbm5Nbo5NbqtNjqtNjshmAABmOgBmOjpmZjpmZpBmkLZmtrZmtttmtv9uTU1ubk1ubo5ujqtujshuq8huq+SOTU2Obk2Obm6Ojk2Ojo6Oq8iOq+SOyOSOyP+QOgCQZgCQZjqQZmaQtpCQtraQttuQ29uQ2/+rbk2rjm6rjo6rq26rq8iryOSr5OSr5P+2ZgC2Zjq2ZpC2kGa2tpC2ttu225C229u22/+2/9u2///Ijk3Ijm7Iq27IyMjI5P/I/8jI/+TI///bkDrbkGbbtmbbtpDbtrbb27bb29vb2//b/7bb/9vb///kq27kq47kyI7kyKvk5Kvk5Mjk5OTk5P/k/+Tk///r6+v/AAD/tmb/yI7/25D/27b/29v/5Kv/5Mj/5OT//7b//8j//9v//+T///+sJWyDAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAUmUlEQVR4nO2d/WPcNh3GnfXtWFmpUzrWDcZ6Y2MJULbxVtYBg5TyUpZCgdAxBgkFxtpcumYsF//3WLb8+pV8+kq6s3x+Pr/07FMfy+dPJFn2naMEAAeivisAhg0EAk5AIOAEBAJOQCDgBAQCTkAg4AQEAk5AIOAEBAJOQCDgBAQCTkAg4AQEAk4sW6C9KLpcW5w1Fzv59KYy7zxZN387um5RNa+kdXjmffVb+X50FBg0wQo0v60q+WSiOgrqtStF60exHxDIDmuBlCV1bc1edG7fpnb+0PpR7AcEssOvQDpRPr9m3jMuh4UCrSuDEujJRDfY2ev7zxsCLQmvAu1oe6remyAItCS0As0fPBtF0cWbpRFP74gVGxdvynIZjQYnbYCK4USFVErRBDUC801+IV1+7q5yOQ3deKfcjkhNpTy3n5U5KyLmdyZRdOYVTeFKIM1+VAXmH7xU2/Ns/fxOs2YDoi+B0s895+zdsmBNCaVAe/KoqQQq5GpsuVXkxXxxQ4Y2l9UC/UNu6nLyqSx9Xl249EO3H2WBIkjuuVj/m0lZbHD0JFDpT0Q+96yESqCsRRAvVAKVb9Y2XA/MSkjyY99aVgv0vaLIj8ttXlcWLvzQ7kdRoNpsvtzYmSJ0QKxAoBbiaIpPUfQL8weT/G9arLj0UfriwxelE3TsoGxkyo5rp/np08Cd9Pi8kjcA5xO6rBQoreVv0yLXigbjg4musPRDvx+FQGKzL+/nHaKMEhXZFxNGQxwu9SPQrN5yiEMxi4oZ5vSAZB80FWiv3cTP6n+yrXdJoNxQ+aK9rBYor+Usqr2SuqgF0u+HLJCulv9TvhICyb+CvUgxzR46/QhUay7aoqSHTSNQq41JZpO6M9qzHRlYHdpctfayWqDrRYR8T4Z1DaI1+yEL1CTZyd4RAl1uRA2LXsZA9QFL+qlVf3ZP//qDSaQRqH2IxDDqcmNR8edbBbbbr/ayUiC5QfJqkUCK/ZAFdqrN5jWmUcOiL4HqZJ9aenJbDKyNBBIZdWOIQK3AdvvVXvYlkG4/8gK1/yj/JwTqRilQ7RysEKi+ykQg0fI3Pu32p98OXJFA2v0oBSp3Im+HIVA3OoFan1TeJp25+LUf/V03BmoKtBM1O7R2C0QCVyOQfj/QAtmh68Ja88Z75YyidhDdEGiPzJm0BCKBqxkD6feDjoHyYTwE6kYpkOh/dEdvpuvCWqdu7VnbZnka2DjBPk+Xa/F70SKBaGHSwLT3o+MsDAJ1oJ6JFjOAd2sFqk9RTNotnAdqnYC13hXQwGoCZqfoRhvL4p/z5f9YLFCrcFsgsh8d80AQqAO1QGKoIGZfk6e3875oJ2/6s/nZ/AOdRe1Ps5yJFv9bcaW+0afRQDnzLCZ8yynh+rKYsbq0n0+OLxSIFK56KM1+qGai1XOSw6Kna2Gz6lylmJquyD7Q/HRGeS1sh04CkGthNLA2d9C6NtZe/vq1hQKRwtVMtGY/Oq6FQaAOdFfjZ+Xpbr58u/jQX367vF4ZtRqa4mq8SiDS45HA6jK4LNheLqp0+fPFApHChR/a/ei4Gg+BOtDfD5TdNnPm5Y/kO9lNMmfSxr0Y3c6/n664VM8q+jCVQDvkfiASmN//E11s3g9UW356eyLu00lMBGoXLv3Q7Qe9H0hWAgKtjoDvSBwtgxIo4HuiR8ugBAr4WxmjZVgCpaIE+r2w0TIsgbTfTB3gvaBrwsAECva78aNlaAKBwIBAwAkIBJyAQMAJCAScgEDACQgEnIBAwAkIBJyAQMAJCAScgEDAieUKdAGsIasUiFf8sb8tP/aYFWi9PCZxoiCQRZjHKAjEAQKRKAjEAQKRKAjEAQKRKAjEAQKRKAjEAQKRKAjEAQKRKAjEAQKRKAjEAQKRKAjEAQKRqAEJdJhC165WoCjKNhCZ/fvYsNyq/w2zXo+XvX+Hh6r1aIEswjxGoQXiAIFIFATiAIFI1IAESiCQrzCPUcMR6BAtkLcwj1HDEkixGgJZhHmMgkAcIBCJgkAcIBCJgkAcIBCJgkAcIBCJGo5A6rN4CGQT5jFqMAJpzuIhkE2Yx6hBCaQqDIEswjxGQSAOEIhEQSAOEIhEQSAOEIhEQSAOFx6DwZIKpFqNFsgizGPUUFog3Vk8ujCbMI9RQxJIWRgCWYR5jIJAHCAQiYJAHCAQiYJAHCAQiYJAHCAQiYJAHCAQiRqKQJqbOSCQVZjHqKEIhBbIX1ag9VqqQFp/IJBNmMcoCMQBApEoCMQBApGogQikHUNDIJswj1HDEEh7KRUCWYV5jBqOQJrCEMgizGMUBOIAgUgUBOIAgUgUBOIAgUgUBOIAgUgUBOIAgUgUBOIAgUgUBOIAgUjUMATST0T7EOjgyp+zf4/ijM1fiIV/bcfx1ffaG+MFh3mgQq3XEgXqmIj2INDDWAp0UBNIvn6jtTFecpgHKtR6LVkgXWFXgU5/HxcC7eZtj+B4Gr8p1KrW5BvjZYd5oEKt1zAFOt6Or27nAp3ekiIlogF6o/ZPtTFeeJgHKtR6DVOg3c0bn0hxTrZeKNae3sqbnuPp848aG+OFh3mgQq3XMAX6+FHZ8hzFr9+bxps3HlWN0clW0ShdyFn1DwIAP2h+WEHgPogubJHj5jhtdE628pan6tUg0JA5XIlAu/Fr99PT92k67qECSY14yWF2FaHWa3ldWFcP5uE0vmWJGPdAIOMoCNS2RCzSMZDcGC85zAMVar3WSyCchRlGQaBCoKK1ORKjaMwDmUZBoNog+mo6iH44jd/CTLR5FASqJn22a9e/cC3MMAoCVWOg03vT6go8rsabRQ1BoI6bOXA/kFWYx6gBCNR1MwcEsgrzGDUQgfSFIZBFmMcoCMQBApEoCMQBApEoCMQBApEoCMQBApEoCMQBApEoCMQBApEoCMQBApEoCMQBApEoCMQBApGoAQjUeSkMAtmEeYwagEBogRIIxEtqRHX7A4FswjxGQSAOEIhEQSAOEIhEQSAOEIhEQSAOEIhEhS9Q91k8BLIJ8xgVvEDdN7RCIKswj1GDEKir8GoFWuVPSgAvdP0yhwAtkEWYxyi0QBwgEImCQBwgEImCQBwgEImCQBwgEImCQBwgEIkKXqAF84gQyCbMY1TwAqEFyqMgECOpFrXIHwhkE+YxCgJxgEAkCgJxgEAkCgJxgEAkKnSBFp2EQSCbMI9RoQuEFkhGQSBGUhW10B8IZBPmMQoCcYBAJAoCcYBAJAoCcYBAJCpwgRaehEEgmzCPUWELtOiO+gQCWYV5jApfoAWFIZBFmMcoCMQBApEoCMQBApEoCJQkB8UTC+tP6MHTesyiIFDyMJYCHeB5Yfyo0Qt0+vtYClR/SiGeWGgaNXaBjrfjq9u5QPXnpOKZqaZRYxdod/PGJ/kTC+tPasZTm42jwhZo8US0q0AfPyoeeVl/Vjx9bvyFnFX9IgDww6JfVnhs9OMK87/+urbwg6/tN98uH/udtzZisf4aAg0XA39MBPr8WnRpv1p45n0LgaRGivQOwuwqQq3XErowgyGQSReWChSdvVsuQKAw67WkQfSiwoYCRRvvFAsagbrHQHJjBrWvEeaBCrVeIbdAz/zu7Si6XCzoBMJZmEVUyAKZ+GMo0Pvz21F0bj/pEAjzQFZRYxEoSfbygZBeIMxE20SNR6DkySTaeKVDIFwLs4kakUDJpy+mA6EOgXA13iJqTAIlYiB0ZtIWiAEEIlGjEigbCEUQKMx6BSzQSxdLZ9KBEAQKs17hCtTgU3ItjAEEIlEhC2QyEY17om3CPEYFLJDBl8ISCGQV5jEqcIEWF4ZAFmEeowIWyKgHg0A2YR6jAhYILVA9CgIxkrIoM38gkE2YxygIxAECkahwBTIbAkEgmzCPUeEKhBaoEQWBGEkiytAfCGQT5jEKAnGAQCQKAnGAQCQKAnGAQCQKAnGAQCQKAnGAQCQKAnGAQCQqWIEM5xEhkE2Yx6hQBTK7GShZtUCr+EkJ4AOTH+bIQAtkEeYxKuQWyKgwBLII8xgFgThAIBIFgThAIBIVqkCmJ2EQyCbMY1SoAqEFakVBIEbSY3N/IJBNmMcoCMQBApEoCMQBApEoCMQBApEoCMQBApEoCMQBApEoCMQBApEoCMQBApGoQAUynoiGQDZhHqPCFMj4biAIZBXmMSpcgQwLQyCLMI9REIgDBCJREIgDBCJRYQpkPoaGQDZhHqPCFAgtEImCQIwkhj8QyCbMYxQE4gCBSFSQAj3uR6Cj/BFP+TPC8LQes6ggBeqpBTqoCYTnhRlGhSgQxx+fAu1WzyfEEwtNoyBQSf0Z33hmqmkUBCo52XqheImnNhtHQaCSo/j1e9N488aj5jPki81kLPkXAYAPDo1/WEHgTyA5bo7TRudkK295ql4NAg2HvgTajV+7n56+T9NxDxVIasRLDLOrCLVevpIOGTcDJUuYSBTjHghkHBWmQIzi3gUS0tAxkNwYLyrMAxVqvTwlHTKuxAuWJBDOwgyjAhPokNmBeRSoaG2OxCga80CmUWEJJP3hRPkcRF9NB9EPp/FbmIk2jwpRIFalPE4kbteuf+FamGFUSAIV/VdPAiWn96bVFXhcjTeLCkQgqU4+/OlLIION8YqHeaBCrZdL0mFFAoGUURCog7L5yU+/IJAiCgLpaTQ/CQRSRkEgHXTqBwIpoiCQmlbjkydBIBoFgZQo9IFAyigIpELpDwRSRUEgBZorXxBIEQWBKLoLpxBIEQWBCNoL7xBIEQWB2ujv3IBAiigI1KLjxh8IpIiCQC0gEC8KAjXpuvEQAimiIFCDzjufIZAiCgI16brzGQIpoiBQg8475yGQIgoC1en+5gUEUkRBoDoQiAsEajBYgZb4kwCAAevnE7pBC2QR5jEKLRAHCESiehFowdeXIZAiCgJVHKIFYgOBShb/fgIEUkRBIEH7CzyaJAhEoyBQYuoPBFJFQaAkfxAqBLJi9ALVvv2+8OejIJAiauQCGcuTJUEgGjVugXJ3IJA9oxaI0XvlSRCIRo1YII47eRIEolHjFYjtDwRSRY1XoEVXvhRJEIhGjVYgtj4QSBk1aoG4SRCIRo1VIIsGCAKposYqEPPJF3kSBKJRIxXIpgGCQKqoEQvET4JANGqcAlk1QBBIFTVGgfhTiDIJAtGokQnEvfzVTApBIDxsxSzKKevQgGVXakkC4XFPhlEOWSb62PgTgkB44JxpFO9WeEO4T162qVTBcgTCIy9NoxZksd1xanoMK9VgKQLxHrpr/yGNGXKK7nE4HoBA7cd+X8jRftMfaOn4fDz9PoITSxHoZCtveQqRIJAjK5aCw4oEkhopS/d9dILG/ENfpy6MJ5AWDKJZUf6SeheIjoHkxngxYR6oUOu1XgJxzsK0hHmgQq3XOgmEeSDjKAikBDPRplEQSA2uhRlGQSANuBpvFgWBOEAgEgWBOEAgEgWBOFwAawgEAk6sUKD+uMDsPVdFkPVyqRQEWi1B1gsCUYI8UEmg9YJAlCAPVBJovSAQJcgDlQRaLwgEegMCAScgEHACAgEnIBBwAgIBJyAQcAICASfWSaDP3p3G8ebr/6Vv/KyH2jTYbd0sHgCnt+K3PMSskUDytux487utN46nL/RSoRoBCnQ8jZvfwbJjfQRK/RGNz//ukVv7IZCKg81XfVRqbQQ6nhYfR/WqfAsCEU62nn/Y/kuzYW0Eqn2nMX95em+a92YHiu8brZpcoM/efTWtyjfuZyt+/q7iayyr4yh+Q34R/fTWlT/dk9U6uPLH7fjKfUbOughUfLlakH3BOh0jSnGCESgddeSDtPT1bvWyvxrtZsPoVKCfFnU5uPLtmDc0WheBit8HEWQ/9XAQX70ve7NQurDd+JtpHT/bEjbvxpvvCcn7qln2eR1lmxd/am8mp7ti4YCt9LoKJFukrDcLRSDJQS6QaBOPehMoq8TJlqhWKpCoS9ahtX/cYDHrKlB9ORyBTv/zh598K+tP8xW91Ux28FlVit5fVOmAPTe0LgLVf9pKjIFCFOj03eqo9SxQMRyLs9FiLpCQZ7wCtc/CQhHoeDvbthwDbX7nZ3/470EAAslPK3MHLVBGax5IfirZEepVoOwnt7LaSKfzIUe/AuWDn0SI9EJrDDRagdoz0dlZ2GfZ9Z7j6Vc8zNnbcbKVzySk7qRH7b30JGw7gC7sqDhVP56K843qjHDMAiX/LKZZsmthcpgoPijR4fc2DySv0InjIud+YnGk+hVot/BEXFFNm0cxvxmLQeSoBUobn/rV+Gwm+vXsDy1Vq79O7OGrxYyzqFH85Rv/Fr1arwLVfgs1bRs/ubX587TZfu1RMnaBgBX1SXw+EGj0QCDgBAQCTkAg0CMQCDgBgYATEAg4AYGAExAIOAGBgBMQiMNOJNm4eHNfU2b+y/dXWqeegUAcSoFSzr6jLPJg8gwEAhp2ovP5i6cPJtGG0qC9CAIBHaVASfL5NbUpEAjoqQmUPJlElxVFIBDQUxcoXTiXDaSf3nlWDKufu5u+nuXjo+ti/Ycvpa8u3uyloqsDAnFoCDTLR0GzSTGsvt4Q6LZce053urYeQCAODYHSPux6NhY6l7Y983RUnfVdRRe2F0Vf2k/mf5nU/8saAoE4NARK1blcG/Ps5Q2SXE7teiVbPdOcra0LEIiDQqCSWUOgvbLr2lnvJggCcdAJNP/wV1+N6gLN3y7f21vvURAE4qAU6IOXiusblUDpexVrfV4PgTgoBtH55Y2NL958AIHAIhSn8enZ1nO/rRYrgVSzjGsIBOJAJxLTwY5ctdcaA6310LkCAnFoXcq4XmtqUmXqZ2E7691xVUAgDs2LqeLsqmxqZlF7Hihfv+5tEQTiUAr0tzvF7Rw7+Yzz7eIKxqxaL66OffgiJhJBSeOGsrvZquJ86+wP86vzT8SlsfTFvLgWtnG93zovGQjEoRTozHPlVfb57VSZMy/vF33Vg0lUmx86c+mjviq7GiAQcAICAScgEHACAgEnIBBwAgIBJyAQcAICAScgEHACAgEnIBBwAgIBJyAQcAICAScgEHACAgEnIBBwAgIBJ/4PWo1ybfwUsBAAAAAASUVORK5CYII=" alt="Heat accumulation over time. The dashed line respresents the z_c, the critical amount of heat units for ecodormancy to be broken." />
<div class="figcaption">Heat accumulation over time. The dashed line
respresents the <span class="math inline">\(z_c\)</span>, the critical
amount of heat units for ecodormancy to be broken.</div>
</div>
</div>
</div>
<div id="the-phenologyfitter" class="section level1">
<h1>The phenologyFitter</h1>
<p>The <code>PhenoFlex</code> model can be fitted to phenological data,
provided that sufficient observations are available for the cultivar of
interest. For this kind of model, parameters are usually determined
using an empirical solver. Solvers identify the best combination of
model parameters by trying out different values and gradually adjusting
these parameters, until the objective function - a measure of how far
predictions are from the observed data - does not decrease further. In
this framework, we fit the model using a generalized simulated annealing
algorithm. In contrast to other algorithms, simulated annealing can deal
with discrete data (we calculate the residual sum of squares between
observed and predicted bloom days as objective function). Since
simulated annealing is a stochastic solver, there is a risk of not
finding the overall best parameter combination (global minimum of
residual sum of squares). The generalisation of the basic solver reduces
this risk. Still, the search should be repeated several times with
different initial parameter values and random seeds. This iterative
procedure requires lots of model runs, which can take substantial time
and/or computing power. Here, we only demonstrate the functionality
using a maximum of 10 iterations of the simulated annealing procedure.
In order to achieve reliable parameters, we recommend at least 1000
iterations. We also recommend using many observations of a cultivar’s
spring phenology (many more than in this example), and ideally to
include winter seasons spanning a wide range of temperature
conditions.</p>
<p>For fitting the <code>PhenoFlex</code> model to phenological data, we
have to generate a list of seasons as follows. We are only using 6
seasons in this example, but a real-life application should be based on
at least 15 to 20 seasons or even more, comprising variable temperature
profiles across years.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>SeasonList <span class="ot">&lt;-</span> <span class="fu">genSeasonList</span>(hourtemps<span class="sc">$</span>hourtemps, <span class="at">years=</span><span class="fu">c</span>(<span class="dv">2003</span><span class="sc">:</span><span class="dv">2008</span>))</span></code></pre></div>
<p>Parameters are then fitted using the generalized simulated annealing
algorithm, which is called by the <code>phenologyFitter</code> function
and requires several inputs:</p>
<ul>
<li>an integer vector of observed dates of bloom (or other phenological
stages)</li>
<li>a function describing the model to be fitted, which only takes as
input a data.frame of dates and observed temperatures. Since the
<code>PhenoFlex</code> model has more than one parameter, we have to
wrap it into another function (<code>PhenoFlex_GDHwrapper</code>), which
requires a temperature dataset <code>x</code> and a vector containing
all the parameters of the <code>PhenoFlex</code> model. Within the
wrapper function, this parameter vector is unpacked, with each value
assigned to the respective parameter.</li>
<li>a vector containing initial estimates for all parameters</li>
<li>a vector containing lower bounds for all parameters</li>
<li>a vector containing upper bounds for all parameters</li>
</ul>
<p>The order, in which the <code>PhenoFlex</code> parameters have to be
provided, is given in the description of the
<code>PhenoFlex_GDHwrapper</code> function as follows:</p>
<ol style="list-style-type: decimal">
<li><strong>yc</strong> - chilling requirement; critical value of y,
which defines the end of chill accumulation - default value: 40</li>
<li><strong>zc</strong> - heat requirement; critical value of z, which
defines the end of heat accumulation - default value: 190</li>
<li><strong>s1</strong> - slope parameter that determines the transition
from the chill accumulation to the heat accumulation period in
<code>PhenoFlex</code> - default value: 0.5</li>
<li><strong>Tu</strong> - optimal temperature of the Growing Degree
Hours (GDH) model - default value: 25</li>
<li><strong>E0</strong> - time-independent activation energy of forming
the PDBF - default value: 3372.8 (as in the widely used version of the
Dynamic Model)</li>
<li><strong>E1</strong> - time-independent activation energy of
destroying the PDBF - default value: 9900.3 (as in the widely used
version of the Dynamic Model)</li>
<li><strong>A0</strong> - amplitude of the (hypothetical) process
involved in forming the precursor to the dormancy-breaking factor in the
Dynamic Model - default value: 6319.5 (as in the widely used version of
the Dynamic Model)</li>
<li><strong>A1</strong> - amplitude of the (hypothetical) process
involved in destroying the precursor to the dormancy-breaking factor
(PDBF) in the Dynamic Model - default value: 5.939917e+13 (as in the
widely used version of the Dynamic Model)</li>
<li><strong>Tf</strong> - transition temperature parameter of the
sigmoidal function in the Dynamic Model, also involved in converting
PDBF to Chill Portions - default value: 4</li>
<li><strong>Tc</strong> - upper threshold in the GDH model - default
value: 36<br />
</li>
<li><strong>Tb</strong> - base temperature of the GDH model - default
value: 4</li>
<li><strong>slope</strong> - slope parameter of the sigmoidal function
in the Dynamic Model, which determines what fraction of the PDBF is
converted to a Chill Portion - default value: 1.6</li>
</ol>
<p>Note that the <code>PhenoFlex_GDHwrapper</code> can only fit the
version of the <code>PhenoFlex</code> model that uses a heat model based
on the GDH concept. For use of the Gaussian heat model that can also be
considered by <code>PhenoFlex</code>, use the
<code>PhenoFlex_GAUSSwrapper</code> function.</p>
<p>For this example, we initiate the procedure with the default values,
and we set upper and lower bounds as follows:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>par <span class="ot">&lt;-</span>   <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">190</span>, <span class="fl">0.5</span>, <span class="dv">25</span>, <span class="fl">3372.8</span>,  <span class="fl">9900.3</span>, <span class="fl">6319.5</span>, <span class="fl">5.939917e13</span>,  <span class="dv">4</span>, <span class="dv">36</span>,  <span class="dv">4</span>,  <span class="fl">1.60</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>upper <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">41</span>, <span class="dv">200</span>, <span class="fl">1.0</span>, <span class="dv">30</span>, <span class="fl">4000.0</span>, <span class="fl">10000.0</span>, <span class="fl">7000.0</span>,       <span class="dv">6</span>.e13, <span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">10</span>, <span class="fl">50.00</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">38</span>, <span class="dv">180</span>, <span class="fl">0.1</span>, <span class="dv">0</span> , <span class="fl">3000.0</span>,  <span class="fl">9000.0</span>, <span class="fl">6000.0</span>,       <span class="dv">5</span>.e13,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="fl">0.05</span>)</span></code></pre></div>
<p>Now, we can run the fitter:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>Fit_res <span class="ot">&lt;-</span> <span class="fu">phenologyFitter</span>(<span class="at">par.guess=</span>par, </span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>                           <span class="at">modelfn =</span> PhenoFlex_GDHwrapper,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                           <span class="at">bloomJDays=</span>KA_bloom<span class="sc">$</span>pheno[<span class="fu">which</span>(KA_bloom<span class="sc">$</span>Year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2003</span><span class="sc">:</span><span class="dv">2008</span>))],</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                           <span class="at">SeasonList=</span>SeasonList, <span class="at">lower=</span>lower, <span class="at">upper=</span>upper,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                           <span class="at">control=</span><span class="fu">list</span>(<span class="at">smooth=</span><span class="cn">FALSE</span>, <span class="at">verbose=</span><span class="cn">FALSE</span>, <span class="at">maxit=</span><span class="dv">10</span>,</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>                                        <span class="at">nb.stop.improvement=</span><span class="dv">5</span>))</span></code></pre></div>
<pre><code>## Loading required namespace: parallel</code></pre>
<p>Note that the list <code>control</code> regulates the behavior of the
<code>GenSA</code> algorithm, the solving engine we are using here. Note
further that <code>smooth=FALSE</code> must be set for the
<code>PhenoFlex</code> model, since the objective function, the residual
sum of squares between predicted and observed bloom days is calculated
based on discrete data (days) and is thus not smooth.
<code>verbose</code> controls whether messages from the algorithm are
shown. <code>maxit</code> defines the maximum number of iterations of
the algorithm and should have a value of at least 1000.
<code>nb.stop.improvement</code> is the number of search steps of the
algorithm, after which the solver is stopped when there is no further
improvement of the fit.</p>
<p>In the example above, the values are chosen in a way that allows the
fitter to finish quickly. <em>Thus, the result may not be particularly
meaningful. More reasonable parameters are, for instance, the default
values of <code>phenologyFitter</code></em>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>control<span class="ot">=</span><span class="fu">list</span>(<span class="at">smooth=</span><span class="cn">FALSE</span>, <span class="at">verbose=</span><span class="cn">TRUE</span>, <span class="at">maxit=</span><span class="dv">1000</span>,</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>             <span class="at">nb.stop.improvement=</span><span class="dv">250</span>)</span></code></pre></div>
<p><code>phenologyFitter</code> can also be used with other models. For
instance, in order to fit the <code>StepChill</code> model, we could
add</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>modelfn<span class="ot">=</span>StepChill_Wrapper</span></code></pre></div>
<p>to the argument list of <code>phenologyFitter</code> and adapt the
parameter vectors <code>par</code>, <code>upper</code> and
<code>lower</code> accordingly.</p>
<p>The result of a fitting procedure can be summarized as follows</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">summary</span>(Fit_res)</span></code></pre></div>
<pre><code>
Phenology Fitter

Final RSS:  33.94618 
RMSE     :  2.378591 
R^2      :  1.977668 

data versus predicted:
  data predicted      delta
1  107  105.4167  1.5833333
2  110  106.3333  3.6666667
3  105  103.8333  1.1666667
4  116  119.2500 -3.2500000
5  105  105.1667 -0.1666667
6  115  117.4583 -2.4583333</code></pre>
<p>with <code>data</code> being the days where bloom or any other
phenological event was observed, <code>predicted</code> the day that was
predicted by the model and <code>delta</code> the difference between
<code>data</code> and <code>predicted</code>, i.e. the residual error.
These results can also be visualized using the <code>plot</code>
function</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">plot</span>(Fit_res)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="computing-errors" class="section level1">
<h1>Computing Errors</h1>
<p>Model prediction are usually uncertain, and the possible errors this
may produce should be expressed. To estimate these errors, we use a
bootstrapping technique, which involves the following steps:</p>
<ol style="list-style-type: decimal">
<li>we first predict bloom dates using our fitted PhenoFlex framework
(see above)</li>
<li>for all years in our calibration dataset, we calculate the residuals
of the predictions (observed minus predicted bloom dates)</li>
<li>we then take the whole population of these residuals and draw as
many random samples from it as we have years in our calibration dataset.
In drawing these samples, it is important that they are drawn <em>with
replacement</em>, i.e. all values that were calculated in step 2 are
available each time a sample is drawn.</li>
<li>we add the residuals that we obtained in step 3 to the phenological
dates in our <strong>calibration dataset</strong></li>
<li>we use the resulting dates to again fit the parameters of the
<code>PhenoFlex</code> framework, make predictions <strong>for the
validation dataset</strong> and record the results for each year</li>
<li>we repeat steps 3-5 many times, recording prediction results for
each repetition</li>
<li>based on the population of predicted bloom dates for each year, we
calculate standard deviations of the resulting distribution, as well as
the <span class="math inline">\(16^{th}\)</span> and <span class="math inline">\(84^{th}\)</span> percentiles, which provide
estimates of the standard error. More details on this procedure and the
whole <code>PhenoFlex</code> concept will eventually be provided in a
peer-reviewed paper</li>
</ol>
<p>In short, the residuals are bootstrapped and then the fit is
repeated. This procedure is performed <code>boot.R</code> times.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>Fit_res.boot <span class="ot">&lt;-</span> <span class="fu">bootstrap.phenologyFit</span>(Fit_res, <span class="at">boot.R=</span><span class="dv">10</span>,</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>                                       <span class="at">control=</span><span class="fu">list</span>(<span class="at">smooth=</span><span class="cn">FALSE</span>, <span class="at">verbose=</span><span class="cn">TRUE</span>, <span class="at">maxit=</span><span class="dv">10</span>,</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>                                                    <span class="at">nb.stop.improvement=</span><span class="dv">5</span>),</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                                       <span class="at">lower=</span>lower, <span class="at">upper=</span>upper, <span class="at">seed=</span><span class="dv">1726354</span>)</span></code></pre></div>
<pre><code>## Emini is: 27.93055556
## xmini are:
## 39.11676954 195.5517993 0.3217588819 27.59297429 3372.8 9900.3 6278.621388 5.9399184e+13 7.096261393 31.92723795 2.3951803 1.6 
## Totally it used 1.444 secs
## No. of function call is: 258
## Algorithm reached max number of iterations.
## ========Emini is: 19.32986111
## xmini are:
## 38.57467149 195.0371152 0.1155335754 27.59297429 3372.8 9900.3 6886.043553 5.93991401e+13 7.556121483 31.92723795 2.3951803 1.8951803 
## Totally it used 1.647 secs
## No. of function call is: 296
## Algorithm reached max number of iterations.
## ========It: 8, obj value (lsEnd): 15.11111111 indTrace: 8
## Emini is: 14.19965278
## xmini are:
## 38.60985105 198.6828916 0.1178039946 26.26897196 3359.949112 9900.3 6635.854312 5.939925058e+13 7.556121483 26.76778409 3.502708733 32.51806282 
## Totally it used 2.326 secs
## No. of function call is: 376
## Algorithm reached max number of iterations.
## ========Emini is: 67.50173611
## xmini are:
## 39.11676954 195.5517993 0.3217588819 27.59297429 3372.8 9900.3 6278.621388 5.9399184e+13 7.096261393 31.92723795 2.3951803 1.6 
## Totally it used 1.43 secs
## No. of function call is: 258
## Algorithm reached max number of iterations.
## ========Emini is: 14.95659722
## xmini are:
## 38.23353909 181.1035987 0.1155335754 27.59297429 3372.8 9900.3 6278.621388 5.9399184e+13 7.096261393 31.92723795 2.3951803 1.6 
## Totally it used 1.359 secs
## No. of function call is: 258
## Algorithm reached max number of iterations.
## ========Emini is: 30.59548611
## xmini are:
## 38.23353909 181.1035987 0.1155335754 27.59297429 3372.8 9900.3 6278.621388 5.9399184e+13 7.096261393 31.92723795 2.3951803 1.6 
## Totally it used 1.54 secs
## No. of function call is: 258
## Algorithm reached max number of iterations.
## ========Emini is: 18.68055556
## xmini are:
## 38.23353909 190.8940883 0.3217588819 27.59297429 3372.8 9900.3 6278.621388 5.9399184e+13 7.096261393 31.92723795 2.3951803 1.6 
## Totally it used 1.393 secs
## No. of function call is: 258
## Algorithm reached max number of iterations.
## ========Emini is: 39.421875
## xmini are:
## 38.23353909 190.8940883 0.3217588819 27.59297429 3372.8 9900.3 6278.621388 5.9399184e+13 7.096261393 31.92723795 2.3951803 1.6 
## Totally it used 1.52 secs
## No. of function call is: 258
## Algorithm reached max number of iterations.
## ========It: 1, obj value (lsEnd): 24.83333333 indTrace: 1
## No improvement in 5 iterations
## Emini is: 24.83333333
## xmini are:
## 38.23353909 181.1035987 0.1155335754 27.59297429 3372.8 9900.3 6451.495766 5.9399184e+13 7.096261393 31.92723795 2.3951803 1.6 
## Totally it used 0.953 secs
## No. of function call is: 163
## ========Emini is: 35.98611111
## xmini are:
## 39.11676954 195.5517993 0.3217588819 27.59297429 3372.8 9900.3 6278.621388 5.9399184e+13 7.096261393 31.92723795 2.3951803 1.6 
## Totally it used 1.346 secs
## No. of function call is: 258
## Algorithm reached max number of iterations.
## ========</code></pre>
<p>Like for the result of <code>phenologyFitter</code> there is also a
<code>summary</code> and a <code>plot</code> function for
<code>bootstrap.phenologyFit</code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">summary</span>(Fit_res.boot)</span></code></pre></div>
<pre><code>            par          Err          q16          q84
1  3.911677e+01 4.033898e-01 3.823354e+01 3.911677e+01
2  1.955518e+02 6.906296e+00 1.811036e+02 1.955518e+02
3  3.217589e-01 1.084531e-01 1.155336e-01 3.217589e-01
4  2.759297e+01 4.186863e-01 2.759297e+01 2.759297e+01
5  3.372800e+03 4.063808e+00 3.372800e+03 3.372800e+03
6  9.900300e+03 0.000000e+00 9.900300e+03 9.900300e+03
7  6.278621e+03 2.100437e+02 6.278621e+03 6.554737e+03
8  5.939918e+13 2.647653e+07 5.939918e+13 5.939918e+13
9  7.096261e+00 1.938940e-01 7.096261e+00 7.353783e+00
10 3.192724e+01 1.631563e+00 3.192724e+01 3.192724e+01
11 2.395180e+00 3.502312e-01 2.395180e+00 2.395180e+00
12 1.600000e+00 9.767219e+00 1.600000e+00 1.765301e+00</code></pre>
<p>with <code>par</code> being the estimated parameter values,
<code>Err</code> the standard deviation of the bootstrap distribution
and <code>q16</code> and <code>q84</code> the 16. and 84. percentiles,
respectively.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">plot</span>(Fit_res.boot)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>This plot now shows observed bloom dates, as well as bloom dates
predicted with the <code>PhenoFlex</code> model, including an estimate
of prediction uncertainty (shown as error bars).</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
